{
  "title": "Kanshi",
  "url": "https://wiki.archlinux.org/title/Kanshi",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- Sway\n\nkanshi allows you to define output profiles that are automatically enabled and disabled on hotplug. For instance, this can be used to turn a laptop's internal screen off when docked.\n\nThis is a Wayland equivalent for tools like autorandr. kanshi can be used on Wayland compositors supporting the wlr-output-management protocol.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install kanshi or kanshi-gitAUR.\n\n"
    },
    {
      "title": "Basic",
      "level": 3,
      "content": "Create kanshi configuration file:\n\n```\n~/.config/kanshi/config\n```\n\n```\nprofile {\n\toutput LVDS-1 disable\n\toutput \"Some Company ASDF 4242\" mode 1600x900 position 0,0\n}\n\nprofile {\n\toutput LVDS-1 enable scale 2\n}\n```\n\nEach output profile is delimited by brackets. It contains several output directives (whose syntax is similar to sway-output(5)). A profile will be enabled if all of the listed outputs are connected.\n\n"
    },
    {
      "title": "Advanced",
      "level": 3,
      "content": "For easier managment of multiple setups (e.g. Internal laptop monior only, Docked to one monitor at home, Docked to two work monitors, ...) you can define defaults for the outputs used inside profiles and assign them aliases. The defaults will apply to all profiles where the respective output is mentioned. For more see kanshi(5)).\n\n```\n~/.config/kanshi/config\n```\n\n```\noutput \"Dell Inc. DELL S2721DGF G52TR83\" {\n  mode 2560x1440@165.08\n  position 1280,0\n  scale 2\n  alias $HOME_1\n}\n\noutput \"LG Display 0x058B Unknown\" {\n  mode 2560x1440@59.99800\n  position 0,0\n  scale 2\n  alias $INTERNAL\n}\n\nprofile home_1 {\n  output $INTERNAL disable\n  output $HOME_1 enable\n}\n```\n\nNote that the $INTERNAL output has as third segment UNKNOWN. This is because kanshi needs all three fields (manufacturer, model and serial number) to be populated. If one is missing the string UNKNOWN has to be used.\n\nYou can find out these values with a command like hyprctl monitors which will display all three of thoose in its output.\n\n```\nhyprctl monitors\n```\n\n```\nmake: LG Display\nmodel: 0x058B\nserial:\n```\n\nIt is also possible to further integrate kanshi with your workflow by using the exec directive to execute a command once the profile was succesfully applied.\n\n```\n~/.config/kanshi/config\n```\n\n```\nprofile home_1 {\n  output $INTERNAL disable\n  output $HOME_1 enable\n  exec uwsm app -- $HOME/.config/hypr/scripts/move-workspaces.sh \"LG Display 0x058B\"\n}\n```\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "Run the command:\n\n```\n$ kanshi\n```\n\nSee #Manage kanshi with systemd for an automated usage.\n\n"
    },
    {
      "title": "Manage kanshi with systemd",
      "level": 3,
      "content": "Create and start ~/.config/systemd/user/sway-session.target (if you don't have created yet) by following Sway#Manage Sway-specific daemons with systemd.\n\nCreate the kanshi.service file:\n\n```\n~/.config/systemd/user/kanshi.service\n```\n\n```\n[Unit]\nDescription=Dynamic output configuration for Wayland compositors\nDocumentation=https://sr.ht/~emersion/kanshi\nBindsTo=sway-session.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/kanshi\n\n[Install]\nWantedBy=sway-session.target\n```\n\nEnable this user unit. It is only activated when Sway is running and deactivated when Sway stops.\n\n"
    },
    {
      "title": "Workspace number starts from 2 in external monitor after wake up",
      "level": 3,
      "content": "If you have a configuration like above, when you connected a second display to your computer, the workspace in the second display should start from 1 since the first display is disabled. This should be the case when you plugged your monitor in the first time or after starting the system. But after sleep, this number might be 2. In this case just move the first workspace to this monitor by adding a directive to the kanshi configuration file:\n\n```\n~/.config/kanshi/config\n```\n\n```\nprofile {\n\toutput LVDS-1 disable\n\toutput \"Some Company ASDF 4242\" mode 1600x900 position 0,0\n\t# We've added this directive here (do not forget to update the output name):\n\texec swaymsg workspace 1, move workspace to HDMI-A-1\n}\n\nprofile {\n\toutput LVDS-1 enable scale 2\n}\n```\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Official website\n- Source code and documentation\n\n"
    }
  ]
}