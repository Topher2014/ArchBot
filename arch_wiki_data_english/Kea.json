{
  "title": "Kea",
  "url": "https://wiki.archlinux.org/title/Kea",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- Network configuration\n- Network tools\n- dhcpcd\n\nKea DHCP is the current Dynamic Host Configuration Protocol server of the Internet Systems Consortium (ISC).\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the kea package. For additional documentation install kea-docs.\n\nOptional dependencies are:\n\n- krb5 for Kerberos support\n- mariadb as database backend\n- postgresql as database backend\n- python to use Kea Shell\n\n"
    },
    {
      "title": "Configuration",
      "level": 2,
      "content": "The configuration files are located under /etc/kea. The content of the configuration files uses JSON structures. For special configurations that are not yet included in the following examples, please refer to the Kea documentation.\n\n"
    },
    {
      "title": "IPv4 DHCP",
      "level": 3,
      "content": "To use DHCP for IPv4, the configuration file /etc/kea/kea-dhcp4.conf must be adapted and the service kea-dhcp4.service must be activated and started.\n\n- 192.168.0.0/16 – subnet 192.168.0.0, netmask 255.255.0.0\n- 172.16.0.0/12 – subnet 172.16.0.0, netmask 255.240.0.0\n- 10.0.0.0/8 – subnet 10.0.0.0, netmask 255.0.0.0\n\nMake sure to assign a static IP address to the interface on which Kea is listen on.\n\n"
    },
    {
      "title": "Example single subnet configuration",
      "level": 4,
      "content": "Assumptions for the example:\n\n- The net is 192.168.0.0/24\n- DNS server has the IP 192.168.0.1/24\n- Gateway has the IP 192.168.0.254/24\n- Static IP of the DHCP server network interface eth0 is 192.168.0.253/24\n- Kea should provide IPs from 192.168.0.100/24 to 192.168.0.199/24\n\nA minimal configuration file /etc/kea/kea-dhcp4.conf could look like:\n\n```\n/etc/kea/kea-dhcp4.conf\n```\n\n```\n{\n    \"Dhcp4\": {\n        \"interfaces-config\": {\n            \"interfaces\": [ \"eth0/192.168.0.253\" ],\n            \"dhcp-socket-type\": \"raw\"\n        },\n\n        \"subnet4\": [\n            {\n                \"id\": 1,\n                \"subnet\": \"192.168.0.0/24\",\n                \"pools\": [ { \"pool\": \"192.168.0.100 - 192.168.0.199\" } ],\n                \"option-data\": [\n                    {\n                        \"name\": \"routers\",\n                        \"data\": \"192.168.0.254\"\n                    },\n                    {\n                        \"name\": \"domain-name-servers\",\n                        \"data\": \"192.168.0.1\"\n                    }\n                ]\n            }\n        ]\n    }\n}\n```\n\n"
    },
    {
      "title": "Example multiple subnet configuration",
      "level": 4,
      "content": "Assumptions for the example:\n\n- The networks are: Network 1: 192.168.0.0/24 (is a standard physical network) Network 2: 192.168.1.0/24 (is a virtual VLAN network)\n- DNS servers are: Network 1 hosts it's own DNS server at IP: 192.168.0.1 Network 2 uses upstream Google DNS: 8.8.8.8 & 8.8.4.4\n- Gateways are: Network 1: 192.168.0.254/24 Network 2: 192.168.1.254/24\n- Static IP of the DHCP servers are: Network 1: network interface eth0 is 192.168.0.253 Network 2: network interface eth0.100 is 192.168.1.253\n- Kea should provide IPs: Network 1: from 192.168.0.100/24 to 192.168.0.199/24 Network 2: from 192.168.1.2/24 to 192.168.1.252/24\n- You have a couple of static IPs defined: Network 1: Has two special phones with static leases 192.168.0.10 && 192.168.0.11\n- You want to enable maximum debug logging for IPv4 in order to troubleshoot any problems with IP reservation\n\n- Network 1: 192.168.0.0/24 (is a standard physical network)\n- Network 2: 192.168.1.0/24 (is a virtual VLAN network)\n\n- Network 1 hosts it's own DNS server at IP: 192.168.0.1\n- Network 2 uses upstream Google DNS: 8.8.8.8 & 8.8.4.4\n\n- Network 1: 192.168.0.254/24\n- Network 2: 192.168.1.254/24\n\n- Network 1: network interface eth0 is 192.168.0.253\n- Network 2: network interface eth0.100 is 192.168.1.253\n\n- Network 1: from 192.168.0.100/24 to 192.168.0.199/24\n- Network 2: from 192.168.1.2/24 to 192.168.1.252/24\n\n- Network 1: Has two special phones with static leases 192.168.0.10 && 192.168.0.11\n\nA more complex configuration file /etc/kea/kea-dhcp4.conf could look like:\n\n```\n/etc/kea/kea-dhcp4.conf\n```\n\n```\n{\n    \"Dhcp4\": {\n        \"interfaces-config\": {\n            \"interfaces\": [ \"eth0/192.168.0.253\", \"eth0.100/192.168.1.253\" ],\n            \"dhcp-socket-type\": \"raw\"\n        },\n        \"loggers\": [\n          {\n            \"name\": \"kea-dhcp4\",\n            \"severity\": \"DEBUG\",\n            \"debuglevel\": 99,\n            \"output_options\": [\n              {\n                \"output\": \"stdout\"\n              }\n            ]\n          }\n        ],\n        \"subnet4\": [\n            {\n                \"id\": 1,\n                \"subnet\": \"192.168.0.0/24\",\n                \"interface\": \"eth0\",\n                \"pools\": [ { \"pool\": \"192.168.0.100 - 192.168.0.199\" } ],\n                \"option-data\": [\n                    {\n                        \"name\": \"routers\",\n                        \"data\": \"192.168.0.254\"\n                    },\n                    {\n                        \"name\": \"domain-name-servers\",\n                        \"data\": \"192.168.0.1\"\n                    }\n                ],\n                \"reservations\": [\n                {\n                    \"hostname\": \"phone1\",\n                    \"hw-address\": \"1a:1b:1c:1d:1e:1f\",\n                    \"ip-address\": \"192.168.0.10\"\n                },\n                {\n                    \"hostname\": \"phone2\",\n                    \"client-id\": \"01:11:22:33:44:55:66\",\n                    \"ip-address\": \"192.168.0.11\"\n                }\n            ]\n            },\n            {\n                \"id\": 2,\n                \"subnet\": \"192.168.1.0/24\",\n                \"interface\": \"eth0.100\",\n                \"pools\": [ { \"pool\": \"192.168.1.2 - 192.168.1.252\" } ],\n                \"option-data\": [\n                    {\n                        \"name\": \"routers\",\n                        \"data\": \"192.168.1.254\"\n                    },\n                    {\n                        \"name\": \"domain-name-servers\",\n                        \"data\": \"8.8.8.8, 8.8.4.4\"\n                    }\n                ]\n            }\n        ]\n    }\n}\n```\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "Kea includes four systemd unit files:\n\nTable content:\nUnit file | Manual page | Description\nkea-dhcp4.service | kea-dhcp4(8) | The DHCPv4 daemon\nkea-dhcp6.service | kea-dhcp6(8) | The DHCPv6 daemon\nkea-dhcp-ddns.service | kea-dhcp-ddns(8) | The DNS update daemon\nkea-ctrl-agent.service | keactrl(8) | Exposing a REST interface for managing Kea servers\n\nThe configuration file for DHCPv4 can be checked for errors by running the command:\n\n```\n# kea-dhcp4 -t /etc/kea/kea-dhcp4.conf\n```\n\nIf everything looks good, then you can enable/start kea-dhcp4.service.\n\n"
    }
  ]
}