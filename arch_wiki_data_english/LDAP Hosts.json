{
  "title": "LDAP Hosts",
  "url": "https://wiki.archlinux.org/title/LDAP_Hosts",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **This article or section needs language, wiki syntax or style improvements. See Help:Style for reference.** This article or section needs language, wiki syntax or style improvements. See Help:Style for reference.\n\nThis article or section needs language, wiki syntax or style improvements. See Help:Style for reference.\n\nNote: **This article or section is out of date.** This article or section is out of date.\n\nThis article or section is out of date.\n\nRelated articles\n\n- OpenLDAP\n- LDAP Authentication\n\nThis document will allow you to put your /etc/hosts into your LDAP server. At first make sure you have an LDAP server up and running (take LDAP authentication as an introduction). Next you need to create a proper ldif file from /etc/hosts. Actually mine is like:\n\n```\n127.0.0.1 localhost\n192.168.1.1 gojira.marex.local gojira\n192.168.1.50 gamera.marex.local gamera\n192.168.1.51 iris.marex.local iris\n192.168.1.52 zedan.marex.local zedan\n```\n\nWhere 127.0.0.1 is localhost (of course), 192.168.1.1 is the LDAP server, followed by at least 3 workstation (gamera, iris & zedan). For a ldif file you need to create a ou for your hosts and each host (I will call the next file hosts.ldif):\n\n```\ndn: ou=Hosts,dc=marex,dc=local\nobjectClass: organizationalUnit\nobjectClass: top\nou: Hosts\n\ndn: cn=gojira+ipHostNumber=192.168.1.1,ou=Hosts,dc=marex,dc=local\nobjectClass: ipHost\nobjectClass: device\nobjectClass: top\ncn: gojira\nipHostNumber: 192.168.1.1\n\ndn: cn=gamera+ipHostNumber=192.168.1.50,ou=Hosts,dc=marex,dc=local\nobjectClass: ipHost\nobjectClass: device\nobjectClass: top\ncn: gamera\nipHostNumber: 192.168.1.50\n\ndn: cn=iris+ipHostNumber=192.168.1.51,ou=Hosts,dc=marex,dc=local\nobjectClass: ipHost\nobjectClass: device\nobjectClass: top\ncn: iris\nipHostNumber: 192.168.1.51\n\ndn: cn=zedan+ipHostNumber=192.168.1.52,ou=Hosts,dc=marex,dc=local\nobjectClass: ipHost\nobjectClass: device\nobjectClass: top\ncn: zedan\nipHostNumber: 192.168.1.52\n```\n\nNext put the file into your LDAP server with your credentials (output truncated):\n\n```\n$ ldapadd -x -W -D 'cn=ldapadmin,dc=marex,dc=local' -h 192.168.1.1 -p 389 -f hosts.ldif\n...\nadding new entry \"cn=zedan+ipHostNumber=192.168.1.52,ou=Hosts,dc=marex,dc=local\"\n```\n\nIf everything filled up then edit your /etc/nss_ldap.conf and change the line beginning with nss_base_hosts to the following:\n\n```\nnss_base_hosts          ou=Hosts,dc=marex,dc=local?one\n```\n\nNow change the /etc/hosts in that way that only localhost, the LDAP server and the own name of the workstation exist. An example how it could look on the workstation gamera:\n\n```\n127.0.0.1 localhost\n192.168.1.1 gojira.marex.local gojira\n192.168.1.50 gamera.marex.local gamera\n```\n\nOn the LDAP server you can ignore every workstation. Finally you need to edit the hosts entry in your /etc/nsswitch.conf:\n\n```\nhosts:          files dns ldap\n```\n\nNow test your configuration:\n\n```\n$ getent hosts\n127.0.0.1       localhost\n192.168.1.1     gojira.marex.local gojira\n192.168.1.50    gamera.marex.local gamera\n192.168.1.1     gojira\n192.168.1.50    gamera\n192.168.1.51    iris\n192.168.1.52    zedan\n```\n\nNote: **This article or section is out of date.** This article or section is out of date.\n\nThis article or section is out of date.\n\nThe first 3 lines are from /etc/hosts, the last 4 lines are from your LDAP server. Finally to get ping working with LDAP you need to start nscd:\n\n```\n$ mkdir -p /var/db/nscd\n$ mkdir -p /var/run/nscd\n$ /etc/rc.d/nscd start\n$ ping iris\nPING iris (192.168.1.51) 56(84) bytes of data.\n...\n```\n\n"
    }
  ]
}