{
  "title": "Logrotate",
  "url": "https://wiki.archlinux.org/title/Logrotate",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- Cron\n- systemd/Timers\n\nFrom https://github.com/logrotate/logrotate:\n\nBy default, logrotate's rotation consists of renaming existing log files with a numerical suffix, then recreating the original empty log file. For example, /var/log/syslog.log is renamed /var/log/syslog.log.1. If /var/log/syslog.log.1 already exists from a previous rotation, it is first renamed /var/log/syslog.log.2. (The number of backlogs to keep can be configured.)\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Logrotate can be installed with the logrotate package.\n\nBy default, logrotate runs daily using a systemd timer: logrotate.timer.\n\n"
    },
    {
      "title": "Configuration",
      "level": 2,
      "content": "The primary configuration file for logrotate which sets default parameters is /etc/logrotate.conf; additional application-specific configuration files are included from the /etc/logrotate.d directory. Values set in application-specific configuration files override those same parameters in the primary configuration file. See logrotate.conf(5) for configuration examples and a reference of available directives.\n\nTo verify if logrotate works correctly, run it in debug mode, in this mode it does nothing except producing debug output:\n\n```\n$ logrotate --debug /etc/logrotate.conf\n```\n\n"
    },
    {
      "title": "Compressing logs",
      "level": 3,
      "content": "Logrotate can compress logs with a custom command like zstd.\n\n```\n/etc/logrotate.conf\n```\n\n```\ncompress\ncompresscmd /usr/bin/zstd\ncompressext .zst\ncompressoptions -T0 --long\nuncompresscmd /usr/bin/unzstd\n```\n\nSee logrotate.conf(5) and zstd(1) for more details.\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "logrotate is usually run through the systemd service: logrotate.service.\n\nTo run logrotate manually:\n\n```\n# logrotate /etc/logrotate.conf\n```\n\nTo rotate a single log file:\n\n```\n# logrotate /etc/logrotate.d/mylog\n```\n\nTo simulate running your configuration file (dry run):\n\n```\n# logrotate --debug /etc/logrotate.d/mylog\n```\n\nTo force running rotations even when conditions are not met, run:\n\n```\n# logrotate -vf /etc/logrotate.d/mylog\n```\n\nSee logrotate(8) for more details.\n\n"
    },
    {
      "title": "exim log not rotated",
      "level": 3,
      "content": "If you have set the olddir variable in /etc/logrotate.conf, you will get a message such as:\n\nerror: failed to rename /var/log/exim/mainlog to /var/log/old/mainlog.1: Permission denied\n\nTo fix this, add the user exim to the group log. Then change the group of the olddir, usually /var/log/old, to log instead of the default root.\n\n"
    },
    {
      "title": "Check logrotate status",
      "level": 3,
      "content": "Logrotate rotations are usually logged to /var/lib/logrotate.status (the -s option allows you to specify another state file):\n\n```\n/var/lib/logrotate.status\n```\n\n```\n\"/var/log/mysql/query.log\" 2016-3-20-5:0:0\n\"/var/log/samba/samba-smbd.log\" 2016-3-21-5:0:0\n\"/var/log/httpd/access_log\" 2016-3-20-5:0:0\n...\n```\n\n"
    },
    {
      "title": "Skipping log because parent directory has insecure permission",
      "level": 3,
      "content": "Configure which user and which group has to job /etc/logrotate.d/job to be run with:\n\n```\nfile-to-be-rotated {\n    su user group\n    rotate 4\n}\n```\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Gentoo:Logrotate\n- logrotate(8) manual page\n- logrotate.conf(5) manual page\n\n"
    }
  ]
}