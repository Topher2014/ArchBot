{
  "title": "Lenovo IdeaPad Flex 5 14alc05",
  "url": "https://wiki.archlinux.org/title/Lenovo_IdeaPad_Flex_5_14alc05",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **This article or section does not follow the Laptop page guidelines.** This article or section does not follow the Laptop page guidelines.\n\nThis article or section does not follow the Laptop page guidelines.\n\nTable content:\nHardware | PCI/USB ID | Working?\nGPU | 1002:164c | Yes\nAudio | 1022:15e3 | Yes\nWi-Fi | 8086:2723 | Yes\nBluetooth | 8087:0029 | Yes\nTouchpad |  | Yes\nTouchscreen |  | Yes\nWebcam | 5986:212a | Yes\nFingerprint sensor | 27c6:55b4 06cb:00be | Yes\nPen input |  | Yes\nAccelerometer | 1022:15e4 | Yes\nSD-card reader | 10ec:522a | Yes\n\n06cb:00be\n\nThe IdeaPad Flex 5 14alc05 is a 14-inch AMD Lucienne (Ryzen 5000)-based convertible from Lenovo.\n\n"
    },
    {
      "title": "Firmware",
      "level": 2,
      "content": "fwupd does not officially support this device but it can still be used to apply UEFI firmware updates.[1]\n\n"
    },
    {
      "title": "Updating bios",
      "level": 3,
      "content": "- UEFI settings might be reset, including the boot entry, so make sure you can set up the boot entry for your install after the UEFI update. See efibootmgr for more information.\n- The commands fwupdate -l and fwupdate -i may no longer work (error below), but fwupdate -a still works.\n\n```\n(fwupdate:10680): FuPluginUefiCapsule-WARNING **: 12:47:47.256: SMBIOS BIOS Characteristics Extension Byte 2 is invalid -- UEFI Specification is unsupported, but /sys/firmware/efi exists: SMBIOS not supported\nSegmentation fault (core dumped)\n```\n\n- This article is a copy of the Lenovo IdeaPad Flex 5 14ARE05 BIOS update Guide adapted for this model.\n\n"
    },
    {
      "title": "Pre update",
      "level": 4,
      "content": "- Install the innoextract, udisks2 and fwupd packages.\n- Download bios update exe file.[2]\n\n"
    },
    {
      "title": "Procedure",
      "level": 4,
      "content": "Run the following commands:\n\n- Extract the bios .cap file:\n\n```\n$ innoextract file.exe\n```\n\n- Get the GUID number of your system firmware for the next step. You should get something that looks like example below:\n\n```\n# fwupdate -l\n```\n\n```\nsystem-firmware type, {e20bafd3-9914-4f4f-9537-3129e090eb3c} version 22315982 can be updated to any version above 22315981\ndevice-firmware type, {e3be8073-66a6-4bf6-966a-c0d58b486c40} version 1 can be updated to any version above 0\ndevice-firmware type, {c85ba1bc-54a7-4aab-9337-eed4746bf09f} version 0 can be updated to any version above 4294967295\n```\n\n- Schedule the update for the next system reboot, using extracted .cap file:\n\n```\n# fwupdate -a e20bafd3-9914-4f4f-9537-3129e090eb3c /path/to/file.cap\n```\n\n- Verify that the update is pending:\n\n```\n# fwupdate -i\n```\n\n- Reboot if there are no errors and if update is pending.\n\n- When the update completes it will boot into the boot menu. At this point it is safe to interact with the device again.\n\n- Install edk2-shell\n- Build MdeModulePkg\n\n- Copy the extracted .cap file, the UEFI Shell at /usr/share/edk2-shell/x64/Shell_Full.efi and the built CapsuleApp.efi to your efi root. (probably /boot/efi/)\n- Reboot into the UEFI Shell.\n\n- Go into the efi root.\n\n```\nSHELL> FS0:\n```\n\n```\nFS0>\n```\n\n- Check for the files with ls.\n- Run FS0> CapsuleApp.efi file.cap\n\n- When the update completes it will boot into the boot menu. At this point it is safe to interact with the device again.\n\n"
    },
    {
      "title": "Post update",
      "level": 4,
      "content": "- Disable secure boot in the settings to be able to boot into Linux.\n- If your boot loader is not detected, boot into a usb with Arch and use arch-chroot to reinstall your boot loader or use efibootmgr to create a boot entry.\n\n"
    },
    {
      "title": "Secure Boot",
      "level": 3,
      "content": "The BIOS accepts custom Secure Boot keys. To enroll them, you have to use KeyTool from efitools. Follow the guide under Secure Boot#Using KeyTool.\n\n"
    },
    {
      "title": "Wireless",
      "level": 2,
      "content": "Note: **This article or section is out of date.** This article or section is out of date.\n\nThis article or section is out of date.\n\nThe Ideapad Flex 5 14alc05 may come with either Wi-Fi 5 (802.11ac 2x2) or Wi-Fi 6 (802.11ax 2x2), both equipped with Bluetooth 5.0 and connected via M.2 slot (see the PSREF for device specifications). However, Lenovo sources these cards from multiple companies. Depending on the hardware layout, this device may have either an Intel or a Realtek Wi-Fi card. Intel Wi-Fi cards should work out of the box, reliably and with full performance. Realtek on the other hand does not support Linux, and so Wi-Fi will not work out of the box.\n\nIf the card is a Realtek 8852AE or similar, a driver is available as rtw89-dkms-gitAUR.\n\n"
    },
    {
      "title": "Touchpad/Touchscreen",
      "level": 2,
      "content": "Sometimes the touchpad and touchscreen will not work after booting due to missing module dependencies, pinctrl_amd is unavailable when the modules for the touchpad/touchscreen get loaded.\n\nTo use the touchpad/touchscreen reliably after booting, create the following file:\n\n```\n/etc/modprobe.d/touchpad.conf\n```\n\n```\nsoftdep hid-multitouch pre: pinctrl_amd\nsoftdep i2c_hid pre: pinctrl_amd\nsoftdep i2c_designware pre: pinctrl_amd\nsoftdep wacom pre: pinctrl_amd\n```\n\n"
    },
    {
      "title": "Fingerprint sensor",
      "level": 2,
      "content": "Depending on your specific model, you may have a 27c6:55b4 (Goodix) or a 06cb:00be (Synaptics). The process will differ depending on your reader, so first use lsusb to determine which one you have.\n\n"
    },
    {
      "title": "Goodix",
      "level": 3,
      "content": "Note: **This article or section is out of date.** This article or section is out of date.\n\nThis article or section is out of date.\n\nNote: **must not be used for security purposes** \n\nFollow this guide.\n\n"
    },
    {
      "title": "Synaptics",
      "level": 3,
      "content": "For installation, the Windows driver will be downloaded and extracted. To do so, you need to install the innoextract package beforehand. You also need meson and ninja.\n\nIn your chosen directory, run\n\n```\n$ git clone https://github.com/Popax21/synaTudor/\n$ cd synaTudor\n$ arch-meson build\n$ cd build\n$ ninja\n# ninja install\n```\n\nFor the module to work, you need to have the libfprint-tod-gitAUR fork installed instead of libfprint. You can now follow the steps in fprint or use your DE to configure your sensor!\n\n"
    },
    {
      "title": "Accelerometer",
      "level": 2,
      "content": "While there used to be problems (See https://bbs.archlinux.org/viewtopic.php?pid=1933133#p1933133 and https://bugzilla.kernel.org/show_bug.cgi?id=212615), installing iio-sensor-proxy seems to enable rotation support in compatible desktop environments.\n\n"
    },
    {
      "title": "Power management",
      "level": 2,
      "content": "Note: **This article or section is a candidate for merging with Laptop/Lenovo#Lenovo.** This article or section is a candidate for merging with Laptop/Lenovo#Lenovo.\n\nThis article or section is a candidate for merging with Laptop/Lenovo#Lenovo.\n\n(see Lenovo IdeaPad 5 14are05#Power management, similar methods)\n\n"
    },
    {
      "title": "System Performance Mode",
      "level": 3,
      "content": "There are 3 performance modes available: Intelligent Cooling, Extreme Performance and Battery Saving. To set them, you need to call the corresponding ACPI methods.\n\nFirst install acpi_call (acpi_call-lts for LTS kernel, acpi_call-dkms for other kernels) and load the kernel module:\n\n```\n# modprobe acpi_call\n```\n\nSet it to Battery Saving mode:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.DYTC 0x0013B001' > /proc/acpi/call\n```\n\nSet it to Extreme Performance mode:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.DYTC 0x0012B001' > /proc/acpi/call\n```\n\nSet it to Intelligent Cooling mode:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.DYTC 0x000FB001' > /proc/acpi/call\n```\n\nTo verify your setting:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.PFMM' > /proc/acpi/call\n# cat /proc/acpi/call; printf '\\n'\n```\n\nwhere 0x0 stands for Battery Saving, 0x1 for Extreme Performance and 0x2 for Intelligent Cooling.\n\n"
    },
    {
      "title": "Battery Conservation",
      "level": 3,
      "content": "Similarly to #System Performance Mode, make sure you have set up acpi_call.\n\nTurn on:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x03' > /proc/acpi/call\n```\n\nTurn off:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x05' > /proc/acpi/call\n```\n\nTo verify your setting:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.SMBM' > /proc/acpi/call\n# cat /proc/acpi/call; printf '\\n'\n```\n\nwhere 0x0 stands for off and 0x1 stands for on.\n\nThere is also an alternative way to control the conservation mode of the battery.\n\n"
    },
    {
      "title": "Rapid Charge",
      "level": 3,
      "content": "Make sure you have set up acpi_call.\n\nTurn on:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x07' > /proc/acpi/call\n```\n\nTurn off:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x08' > /proc/acpi/call\n```\n\nTo verify your setting:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.QKCM' > /proc/acpi/call\n# cat /proc/acpi/call; printf '\\n'\n```\n\nwhere 0x0 stands for off and 0x1 stands for on.\n\nNote however, that this is untested!\n\n"
    },
    {
      "title": "Hidden BIOS menu",
      "level": 2,
      "content": "See https://forums.lenovo.com/topic/findpost/1092/5018261/5262868. You can turn on S3 sleep support.\n\n"
    },
    {
      "title": "Suspend",
      "level": 2,
      "content": "See Power management/Suspend and hibernate#Changing suspend method for the general context in which this workaround applies.\n\nNote: **This article or section needs language, wiki syntax or style improvements. See Help:Style for reference.** This article or section needs language, wiki syntax or style improvements. See Help:Style for reference.\n\nThis article or section needs language, wiki syntax or style improvements. See Help:Style for reference.\n\n- Get acpidump and iasl, provided by the acpica package.\n- Dump all your ACPI files into a directory:\n\n```\n$ mkdir ~/acpi/\n$ cd ~/acpi/\n# acpidump -b\n```\n\n- Decompile the DSDT table\n\n```\n$ iasl -e *.dat -d dsdt.dat\n```\n\n- Patch the decompiled DSDT table (dsdt.dsl), using this patch:\n\n```\n$ patch -p1 < dsdt.patch\n```\n\n- Compile the modified DSDT table\n\n```\n$ iasl -ve -tc dsdt.dsl\n```\n\n- Make a cpio archive\n\n```\n$ mkdir -p kernel/firmware/acpi\n$ cp dsdt.aml kernel/firmware/acpi\n$ find kernel | cpio -H newc --create > acpi_override\n```\n\n- Copy created cpio file to boot:\n\n```\n# cp acpi_override /boot\n```\n\n- Reboot\n\n"
    },
    {
      "title": "Function keys",
      "level": 2,
      "content": "Table content:\nKey | Visible?1 | Marked?2 | Effect\nFn+Esc | No | Yes | Toggles Fn lock3\nFn+F1 | Yes | Yes | XF86AudioMute\nFn+F2 | Yes | Yes | XF86AudioLowerVolume\nFn+F3 | Yes | Yes | XF86AudioRaiseVolume\nFn+F4 | Yes | Yes | XF86AudioMicMute\nFn+F5 | Yes | Yes | XF86MonBrightnessDown\nFn+F6 | Yes | Yes | XF86MonBrightnessUp\nFn+F7 | Yes | Yes | Super_L+p\nFn+F8 | Yes | Yes | XF86RFKill\nFn+F9 | Yes | Yes | Super_L+i\nFn+F10 | Yes | Yes | Super_L+l\nFn+F11 | Yes | Yes | Alt_L+Caps_Lock+Tab\nFn+F12 | Yes | Yes | XF86Calculator\nFn+Insert | No | Yes | Lenovo Vantage4\nFn+PrtSc | No | Yes | Screenshot4\nFn+Space | No | Yes | Keyboard Backlight Brightness\nFn+Left | Yes | Yes | Home\nFn+Right | Yes | Yes | End\nFn+Up | Yes | Yes | PageUp\nFn+Down | Yes | Yes | PageDown\n\n1. The key is visible to xev and similar tools.\n1. The physical key has a symbol on it, which describes its function.\n1. The key has a status indicator LED in it similar to CapsLock\n1. The Lenovo function keys driver provides special functionality for this key on Windows (See https://pcsupport.lenovo.com/de/en/products/laptops-and-netbooks/flex-series/flex-5-14alc05/82hu/82hu002yus/r9137p7f/downloads/driver-list/component?name=Mouse,%20Pen%20and%20Keyboard, under \"Lenovo Fn and Function Keys for Windows 10 (64-bit)\")\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Official support page\n- Product Specifications Reference (PSREF)\n\n"
    }
  ]
}