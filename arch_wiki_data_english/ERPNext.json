{
  "title": "ERPNext",
  "url": "https://wiki.archlinux.org/title/ERPNext",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "ERPNext is an open source ERP software licensed under GPL3 which is accessed via the web browser. Functionalities are separated into logical sections which makes it convenient to only choose those capabilities which are needed. This enables many different use cases.\n\nThere is plenty of documentation. Moreover, a forum serves as a gathering point for discussions among users.\n\nIn contrast to its alternative Odoo, it is completely open source and does not have a proprietary version.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "The MariaDB database must be started before installing the package erpnextAUR.\n\nInternally, the software is unusual to install because it uses its own installer frappe-benchAUR.\n\nYou may want to use an HTTP server like Nginx or Apache to run ERPNext behind a reverse proxy.\n\n"
    },
    {
      "title": "Dependencies",
      "level": 3,
      "content": "The installer uses a virtual environment for Python. Therefore, Python dependencies are not required system-wide.\n\n"
    },
    {
      "title": "Bug (Access to database denied)",
      "level": 3,
      "content": "During the setup, a database needs to be created. This happens with the own user. For the database creation, the user \"root\" is needed. By default, it has set an empty password but is accessed via the user \"root\". As this is not possible in the installation, the user \"root\" needs to be set a password.\n\n"
    },
    {
      "title": "Update",
      "level": 2,
      "content": "Updating requires manual action because the installation will fail if the software's database named \"erpnext\" already exists.\n\nSave your database and delete it.\n\n```\n# mariadb-dump -p -u root erpnext > /tmp/erpnext.sql\n# mariadb -e \"DROP DATABASE erpnext;\" -p -u root\n```\n\nSave your files and encryption key.\n\n```\n# cp -r /usr/share/webapps/erpnext/sites/erpnext/private/ /tmp/erpnext-private/\n# cp -r /usr/share/webapps/erpnext/sites/erpnext/public/ /tmp/erpnext-public/\n# grep -Eo \"^[[:space:]]+\\\"encryption_key\\\": [[:graph:]]+$\" /usr/share/webapps/erpnext/sites/erpnext/site_config.json > /tmp/erpnext-encryption_key.txt\n```\n\nUninstall erpnextAUR and remove its lingering files.\n\n```\n# rm -r /usr/share/webapps/erpnext/\n```\n\nAfterwards, install the package erpnextAUR.\n\nNow, restore your old database and files and remove the backups.\n\n```\n# mariadb -e \"DROP DATABASE erpnext;\" -p -u root\n# mariadb -e \"CREATE DATABASE erpnext;\" -p -u root\n# mariadb -p -u root erpnext < /tmp/erpnext.sql\n# cp -r /tmp/erpnext-private/* /usr/share/webapps/erpnext/sites/erpnext/private/\n# cp -r /tmp/erpnext-public/* /usr/share/webapps/erpnext/sites/erpnext/public/\n# readonly encryption_key=\"$(cat /tmp/erpnext-encryption_key.txt)\"\n# perl -0e \"s|\\\"db_type\\\": \\\"mariadb\\\"|\\\"db_type\\\": \\\"mariadb\\\",\\n${encryption_key//\\\"/\\\\\\\"}|g\" -i -p /usr/share/webapps/erpnext/sites/erpnext/site_config.json\n# rm /tmp/erpnext.sql\n# rm -r /tmp/erpnext-private/\n# rm -r /tmp/erpnext-public/\n# rm /tmp/erpnext-encryption_key.txt\n```\n\nUpgrade the database.\n\n```\n# tmux new-session -s erpnext \"erpnext\"\n# cd /usr/share/webapps/erpnext/\n[erpnext]$ bench migrate\n# tmux send-keys -t erpnext C-c\n```\n\nUltimately, assure the correct ownership.\n\n```\n# chown -R erpnext:erpnext /usr/share/webapps/erpnext/\n```\n\n"
    },
    {
      "title": "Removal",
      "level": 2,
      "content": "As the software creates files on its own pacman cannot keep track of all files. For a complete removal, run:\n\n```\n# rm -r /usr/share/webapps/erpnext/\n```\n\n"
    },
    {
      "title": "Backup",
      "level": 2,
      "content": "Create a backup of the database, see MariaDB#Backup. Additionally, save your files which are located in /usr/share/webapps/erpnext/sites/erpnext/private/ and /usr/share/webapps/erpnext/sites/erpnext/public/.\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "Start the executable erpnext. The root password is required to access the user \"erpnext\". The server runs and can be accessed via http://localhost:8000.\n\n"
    }
  ]
}