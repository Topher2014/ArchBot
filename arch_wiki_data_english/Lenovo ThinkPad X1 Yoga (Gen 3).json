{
  "title": "Lenovo ThinkPad X1 Yoga (Gen 3)",
  "url": "https://wiki.archlinux.org/title/Lenovo_ThinkPad_X1_Yoga_(Gen_3)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Table content:\nHardware | PCI/USB ID | Working?\nTouchpad | (I2C) | Yes\nTrackPoint | (I2C) | Yes\nTouchscreen | 056a:5144 (?) | Yes\nPen | 056a:5146 | Yes\nKeyboard |  | Yes\nGPU | 8086:5917 | Yes\nWebcam | 04f2:b61e | Yes\nEthernet | 8086:15d7 | Yes\nBluetooth | 8087:0a2b | Yes\nMicroSD card slot | 0bda:0328 | Yes\nAudio | 8086:9d71 | Yes\nWireless | 8086:24fd | Yes\nMobile broadband (PCI mode) | 8086:7360 | No\nMobile broadband (USB mode) | 2cb7:0007 | Yes\nFingerprint Reader | 06cb:009a | Yes\n\nThe Lenovo ThinkPad X1 Yoga, 3th generation (X1Y3) is a 2-in-1 convertible laptop introduced in 2018. There are several different models (20ld, 20le, 20lf, 20lg). Its design is closely related to the Lenovo ThinkPad X1 Carbon (Gen 6). It features a 14\" screen, 8th-gen Intel Core processors (Kaby Lake), an integrated stylus, and integrated Intel UHD 620 graphics.\n\nTo ensure you have this version, install the package dmidecode and run:\n\n```\n# dmidecode -s system-version\nThinkPad X1 Yoga 3rd\n```\n\n"
    },
    {
      "title": "Firmware",
      "level": 2,
      "content": "Several Linux users reported their systems were bricked after enabling \"Thunderbolt BIOS assist\" in the UEFI menu. Lenovo has released BIOS version 1.27 which prevents this issue. See this thread on the Lenovo forums for details.\n\nUnder BIOS version 1.24 the embedded controller will no longer spin the fan up properly during high system load causing CPU throttling issues. Reverting to version 1.21 will restore normal functions or you can use the ThinkFanAUR package to control it via the OS. See Fan speed control#ThinkPad laptops for details.\n\n"
    },
    {
      "title": "Updates",
      "level": 3,
      "content": "In August of 2018 Lenovo has joined the Linux Vendor Firmware Service (LVFS) project, which enables firmware updates from within the OS. BIOS updates (and possibly other firmware such as the Thunderbolt controller) can be queried for and installed through fwupd.\n\n"
    },
    {
      "title": "Manual",
      "level": 4,
      "content": "Download the latest BIOS image from the Lenovo Thinkpad X1 Yoga 3rd Gen downloads page. Obtain geteltoritoAUR and run geteltorito.pl -o bios-update.img xxxxxxxx.iso on the downloaded ISO file to create a valid El Torito image file, then flash this file on a USB drive via dd like you would flash Arch installation media. For further information see flashing BIOS from Linux.\n\nThe ThinkPad X1 Yoga supports setting a custom splash image at the earliest boot stage (instead of the red \"Lenovo\" logo), more information can be found in the README.TXT located in the FLASH folder of the update image.\n\n"
    },
    {
      "title": "Mobile broadband",
      "level": 2,
      "content": "Fibocom L850-GL works after turning it into USB mode with https://github.com/xmm7360/xmm7360-usb-modeswitch.\n\nInstall the acpi_call kernel module, then run the xmm2usb tool as root, then wait a few seconds for the USB modem to come up.\n\n"
    },
    {
      "title": "Power management",
      "level": 2,
      "content": "To check whether S3 is recognized and usable by Linux, run:\n\n```\n# journalctl -k --grep \"acpi: pm: \\(supports\"\n```\n\nand check for S3 in the list.\n\n"
    },
    {
      "title": "Enabling S3 sleep",
      "level": 3,
      "content": "Since of May 17, 2019, Lenovo released firmware 1.33, which let you enable \"legacy\" S3 sleep in UEFI/BIOS. You can find the option in ThinkPad Setup: Config > Power and disable Optimized Sleep State for Modern Standby.\n\nReboot and verify whether deep sleep is available, as explained in Power management/Suspend and hibernate#Changing suspend method.\n\n"
    },
    {
      "title": "Fix touchscreen after resume",
      "level": 3,
      "content": "The X1Y3 has a firmware bug where the touchscreen may not come up again after waking up from S3 suspend/resume.\n\nThe following fixes were pulled from: Lenovo Linux Forums\n\n"
    },
    {
      "title": "Using acpi_call",
      "level": 4,
      "content": "Install and enable the acpi_call kernel module.\n\nAdd the following systemd service:\n\n```\n/etc/systemd/system/activate-touch-hack.service\n```\n\n```\n[Unit]\nDescription=Touch wake Thinkpad X1 Yoga 3rd gen hack\nAfter=suspend.target hibernate.target hybrid-sleep.target suspend-then-hibernate.target\n\n[Service]\nExecStart=/bin/sh -c \"echo '\\\\_SB.PCI0.LPCB.EC._Q2A'  > /proc/acpi/call\"\n\n[Install]\nWantedBy=suspend.target hibernate.target hybrid-sleep.target suspend-then-hibernate.target\n```\n\nEnable activate-touch-hack.service.\n\n"
    },
    {
      "title": "Disabling Thunderbolt",
      "level": 4,
      "content": "Some users have reported that disabling Thunderbolt in BIOS -> Security -> IO ports -> Thunderbolt permanently fixes the touchscreen issue. As a consequence, docking stations may have some features disabled.\n\n"
    },
    {
      "title": "Fingerprint reader",
      "level": 2,
      "content": "See Lenovo ThinkPad T480s#Fingerprint reader.\n\n"
    },
    {
      "title": "Accelerometer",
      "level": 2,
      "content": "If you want the screen to auto-rotate if turned upside down or sideways, install the iio-sensor-proxy package. Start the iio-sensor-proxy.service or simply reboot to apply.\n\n"
    },
    {
      "title": "Touchscreen ghost touches",
      "level": 2,
      "content": "Some Thinkpad X1Y3 touchscreens are affected by a hardware issue that manifests itself as \"ghost touch\" events along the outer edges of the screen. On X11, with the xf86-input-wacom driver installed, it is possible to work around this by configuring the tablet driver to ignore touch events in the outermost row of pixels.\n\nFirst, use xsetwacom to show the sensors (touch, stylus etc.) supported by the touchscreen:\n\n```\n# xsetwacom list devices\nWacom Pen and multitouch sensor Finger touch    id: 9   type: TOUCH     \nWacom Pen and multitouch sensor Pen stylus      id: 10  type: STYLUS    \nWacom Pen and multitouch sensor Pen eraser      id: 18  type: ERASER\n```\n\nNote down the ID of the TOUCH sensor, then check the active area of the touchscreen:\n\n```\n# xsetwacom get 9 Area\n0 0 12373 6961\n```\n\nNow configure the Area parameter by moving all edges inward by 1:\n\n```\n# xsetwacom set 9 Area 1 1 12372 6960\n```\n\nIf you are still getting ghost clicks, they might be from the stylus tool, in that case repeat the operation with the stylus ID:\n\n```\n# xsetwacom get 10 Area\n0 0 30935 17401\n# xsetwacom set 10 Area 1 1 30934 17400\n```\n\n"
    },
    {
      "title": "Missing keys on some layouts",
      "level": 2,
      "content": "People using the device with a German keyboard layout will quickly notice that the <> key is missing (to which | is also bound). This can also be the case for other layouts.\n\nTo work around this without switching back to the device's \"native\" layout, the Compose key can be used.\n\n"
    },
    {
      "title": "Function keys",
      "level": 2,
      "content": "Table content:\nKey | Visible?1 | Marked?2 | Effect\nFn+Esc | No | Yes | Enables Fn lock\nFn | Yes | Yes | XF86WakeUp\nFn+F1 | Yes | Yes | XF86AudioMute\nFn+F2 | Yes | Yes | XF86AudioLowerVolume\nFn+F3 | Yes | Yes | XF86AudioRaiseVolume\nFn+F4 | Yes | Yes | XF86AudioMicMute\nFn+F5 | Yes | Yes | XF86MonBrightnessDown\nFn+F6 | Yes | Yes | XF86MonBrightnessUp\nFn+F7 | Yes | Yes | XF86Display\nFn+F8 | Yes | Yes | XF86WLAN\nFn+F9 | Yes | Yes | XF86Tools\nFn+F10 | Yes | Yes | XF86Bluetooth\nFn+F11 | No | Yes | Unknown\nFn+F12 | Yes | Yes | XF86Favorites\nFn+B | Yes | No | Break\nFn+K | Yes | No | ScrollLock\nFn+P | Yes | No | Pause\nFn+S | Yes | No | SysRq\nFn+Left Arrow | Yes | No | Home\nFn+Right Arrow | Yes | No | End\nFn+Space | No | Yes | Toggle Keyboard Backlight\n\n1. The key is visible to xev and similar tools.\n1. The physical key has a symbol on it, which describes its function.\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Product Specifications Reference (PSREF)\n- Hardware maintenance manual\n- User guide\n\n"
    }
  ]
}