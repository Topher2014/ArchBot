{
  "title": "Buildah",
  "url": "https://wiki.archlinux.org/title/Buildah",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- Cgroups\n- Docker\n- Podman\n- Linux Containers\n\nBuildah is a tool that facilitates building Open Container Initiative (OCI) container images. The Buildah package provides a command line tool that can be used to:\n\n- create a working container, either from scratch or using an image as a starting point\n- create an image, either from a working container or via the instructions in a Dockerfile\n- images can be built in either the OCI image format or the traditional upstream docker image format\n- mount a working container's root filesystem for manipulation\n- unmount a working container's root filesystem\n- use the updated contents of a container's root filesystem as a filesystem layer to create a new image\n- delete a working container or an image\n- rename a local container\n\nThe most widely known alternative for building containers is docker. Do note that Buildah does not run containers, for that you may want to consider podman.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the buildah and podman packages or, for the development version, the buildah-gitAUR package.\n\n"
    },
    {
      "title": "Enable support to build unprivileged containers",
      "level": 3,
      "content": "Note: **This article or section is being considered for removal.** This article or section is being considered for removal.\n\nThis article or section is being considered for removal.\n\nUsers wishing to use Buildah to build unprivileged containers need to complete additional setup steps before running podman for the first time.\n\nFinally, create both /etc/subuid and /etc/subgid to contain the mapping to the containerized UID/GID pairs for each user who shall be able to run the containers.[1] The example below is for the root user (and systemd system unit) and an example user buildah:\n\n```\n/etc/subuid\n```\n\n```\nbuildah:100000:65536\n```\n\n```\n/etc/subgid\n```\n\n```\nbuildah:100000:65536\n```\n\nIf you did run podman before applying the changes above, you will get errors when trying to pull images as an unprivileged user. Run podman system migrate to fix it.\n\nIf everything went well then after logging out and logging back in buildah images should not result in error\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "See the Buildah tutorials.\n\n"
    },
    {
      "title": "WARN[0000] \"/\" is not a shared mount, this could cause issues or missing mounts with rootless containers",
      "level": 3,
      "content": "Buildah/Podman running as rootless expects the bind mount to be shared, check if it is set to private:\n\n```\n$ findmnt -o PROPAGATION /\n```\n\n```\nPROPAGATION\nprivate\n```\n\nIn this case see mount(8) ยง Shared subtree operations and set temporarily the mount as shared with:\n\n```\n# mount --make-shared /\n```\n\nTo set it permanently, edit /etc/fstab and add the shared option to the desired mount and reboot. It will result in a entry like:\n\n```\n/etc/fstab\n```\n\n```\n# <device>                                <dir> <type> <options> <dump> <fsck>\nUUID=0a3407de-014b-458b-b5c1-848e92a327a3 /     ext4   defaults,shared   0      1\n```\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Buildah Blog Post Series\n- Containers Organization GitHub projects\n- Podman daemonless container engine\n\n"
    }
  ]
}