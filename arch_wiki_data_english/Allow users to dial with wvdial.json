{
  "title": "Allow users to dial with wvdial",
  "url": "https://wiki.archlinux.org/title/Allow_users_to_dial_with_wvdial",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "WvDial is a Point-to-Point Protocol dialer: it dials a modem and starts ppp in order to connect to the Internet.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the wvdial package.\n\n"
    },
    {
      "title": "Configuration",
      "level": 2,
      "content": "When wvdial starts, it first loads its configuration from /etc/wvdial.conf and ~/.wvdialrc . If /etc/wvdial.conf is not present, the easiest way to create it is to use the provided configuration utility wvdialconf:\n\n```\n# wvdialconf /etc/wvdial.conf\n```\n\nIt helps in generating the configuration file needed by wvdial. wvdialconf detects your modem, and fills in automatically the Modem, maximum Baud rate, and a good initialization string (Init options) and generates or updates the wvdial configuration file (/etc/wvdial.conf) based on this information.\n\nIt is safe to run wvdialconf if a configuration file already exists. In that case, only the Modem, Baud, Init, and Init2 options are changed in the [Dialer Defaults] section, and only if autodetection is successful.\n\nAfter you have filled in your login information, wvdial ought to work. You can move to the next section. However for providers of USB modems that require a specific Init string and user/password combination, mkwvconf-gitAUR can help generate a wvdial configuration (based on the mobile-broadband-provider-info-gitAUR package).\n\nA typical /etc/wvdial.conf looks like this after manual configuration:\n\n```\n[Dialer Defaults]\nInit1 = ATZ\nInit2 = ATQ0 V1 E1 S0=0 &C1 &D2 +FCLASS=0\nModem Type = Analog Modem\nISDN = 0\nModem = /dev/ttyUSB2\nBaud = 9600\n\n[Dialer thenet]\nPhone = *99***1#\nUsername = thenetuser\nPassword = thenetpw\n; Username = 9180****** (If your provider use without Username)\n; Password = 9180****** (If your provider use without Password)\nStupid Mode = 1\nBaud = 460800\nInit3 = AT+CGDCONT=1,\"IP\",\"apn.thenet.net\"\n\n[Dialer mypin]\nInit4 = AT+CPIN=1234\n```\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "There are a few different ways of giving regular users the ability to use wvdial to dial a ppp connection. This document describes three different ways, each of them differ in difficulty to set up and the implication on security.\n\nwvdial is to be run as root with the following command:\n\n```\n# wvdial option\n```\n\nLeave option blank if you have not added a section or if /etc/wvdial.conf is auto-generated.\n\n```\n# wvdial\n```\n\n"
    },
    {
      "title": "suid",
      "level": 3,
      "content": "Note: **every user can run** \n\nAs normal users cannot use wvdial to dial a PPP connection by default, change permissions:\n\n```\n# chmod u+s /usr/bin/wvdial\n```\n\nYou should see the following permissions:\n\n```\n# ls -l /usr/bin/wvdial\n-rwsr-xr-x  1 root root 114368 2005-12-07 19:21 /usr/bin/wvdial\n```\n\n"
    },
    {
      "title": "Group",
      "level": 3,
      "content": "Another, slightly more secure way is to set up a group called dialout (call the group as preferred) and give members of this group permission to run wvdial as root.\n\nFirst create the group and add the users to it:\n\n```\n# groupadd dialout\n# gpasswd -a username dialout\n```\n\nThen set the group and adjust the permissions on wvdial:\n\n```\n# chgrp dialout /usr/bin/wvdial\n# chmod u+s,o= /usr/bin/wvdial\n```\n\nThe files should have the following permissions:\n\n```\n$ ls -l /usr/bin/wvdial\n```\n\n```\n-rwsr-x---  1 root dialout 114368 2005-12-07 19:21 /usr/bin/wvdial\n```\n\n"
    },
    {
      "title": "sudo",
      "level": 3,
      "content": "sudo arguably offers the most secure option to allow regular users to establish dial-up connections using wvdial. It can be used to give permission both on a per-user and group basis. Another benefit of using sudo is that it is only needed to do the setup once; both previous solutions will be \"undone\" when a new package of wvdial is installed.\n\nUse visudo to edit the file /etc/sudoers:\n\n```\n# visudo\n```\n\nTo give a specific user permission to run wvdial as root, add the following line (changing the username):\n\n```\nusername localhost = /usr/bin/wvdial\n```\n\nTo give all members of a group (dialout in this case) the same permission:\n\n```\n%dialout localhost = /usr/bin/wvdial\n```\n\nIf ip addr shows a pppd entry, it means that the session is ready.\n\n"
    },
    {
      "title": "Tips and Tricks",
      "level": 2,
      "content": "The following are applicable to USB modems.\n\n"
    },
    {
      "title": "Low connection speed",
      "level": 3,
      "content": "See USB 3G Modem#Low connection speed.\n\n"
    },
    {
      "title": "Auto Reconnect",
      "level": 3,
      "content": "If wvdial randomly drops connection you can use script below:\n\n```\n#! /bin/bash\n(\n   while : ; do\n       wvdial\n       sleep 10\n   done\n) &\n```\n\n"
    },
    {
      "title": "Multiple devices",
      "level": 3,
      "content": "Often there will be several devices (at /dev/ttyUSB0, /dev/ttyUSB1, /dev/ttyUSB2 for example). If in doubt about which to use, try each of them in turn or use /dev/gsmmodem (a link set up by usb_modeswitch) which should point to the correct one. Once the configuration files are prepared, the internet connection is established by running:\n\n```\n$ wvdial options\n```\n\nIf necessary additional setup commands can be placed in a simple script like this:\n\n```\nusb_modeswitch\nsleep 2\nmodprobe usbserial vendor=0xVVVV product=0xMMMM maxSize=4096\nsleep 2\nwvdial thenet\n```\n\nwhere VVVV is the hexadecimal vendor ID from lsusb, MMMM is the hexadecimal product ID when in modem mode, and \"thenet\" is the name of the section in wvdial.conf which you wish to use. The maxSize option may or may not be necessary. It simplifies matters if you disable the SIM PIN, but if you require it, run wvdial mypin before wvdial thenet.\n\nThe final wvdial command should start pppd and the obained IP address should be visible in the terminal output. At that point the internet connection should be live, which can be easily checked with a web browser or by pinging an external IP address.\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- GitHub repository\n\n"
    }
  ]
}