{
  "title": "W3m",
  "url": "https://wiki.archlinux.org/title/W3m",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- ELinks\n- Lynx\n\nw3m is a text-based web browser as well as a pager like more or less. With w3m you can browse web pages through a Terminal emulator window. Moreover, w3m can be used as a text formatting tool which typesets HTML into plain text.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the w3m package.\n\n"
    },
    {
      "title": "Usage",
      "level": 2,
      "content": "See w3m(1).\n\n"
    },
    {
      "title": "Configuration",
      "level": 2,
      "content": "w3m can either be configured using the in-browser settings menu or by directly modifying its configuration files.\n\nSome of the more advanced options are not available using the settings menu, so it is recommended editing the configuration files themselves.\n\nBy default all configuration files reside in ~/.w3m.\n\n/etc/w3m/config isn't exposed so o (= Option Setting Panel), tab until in an unselected setting (eg a ( )YES), Enter to select that, tab down to an [OK] and Enter on that to leave the panel. You will now have ~/.w3m/config.\n\n"
    },
    {
      "title": "Vim keybinds",
      "level": 3,
      "content": "Replace ~/.w3m/keymap with a custom configuration.\n\n"
    },
    {
      "title": "URL hints",
      "level": 3,
      "content": "w3m supports qutebrowser-like link navigation, simply navigate to your config file and change the following line from display_link_number 0 to display_link_number 1.\n\nAnd add keymap f COMMAND \"RESHAPE ; LINK_BEGIN ; GOTO_LINK\" and keymap F COMMAND \"RESHAPE ; LINK_BEGIN ; TAB_LINK\" to ~/.w3m/keymap.\n\n"
    },
    {
      "title": "Using kittens image protocol",
      "level": 3,
      "content": "Users of the kitty terminal emulator may chose to use its own graphics protocol.\n\nTo do so simply change the following lines in ~/.w3m/config:\n\n```\ninline_img_protocol 0\nimgdisplay w3mimgdisplay\n```\n\nto:\n\n```\ninline_img_protocol 4\nimgdisplay kitty\n```\n\n"
    },
    {
      "title": "Using Iterm2 image protocol",
      "level": 3,
      "content": "Users of the wezterm terminal emulator may chose to use the Iterm2 graphics protocol[dead link 2025-03-15 ⓘ] which WezTerm supports.\n\nTo do so simply change the following lines in ~/.w3m/config:\n\n```\ninline_img_protocol 0\nimgdisplay w3mimgdisplay\n```\n\nto:\n\n```\ninline_img_protocol 3\nimgdisplay iterm2\n```\n\n"
    },
    {
      "title": "Searching",
      "level": 3,
      "content": "You can set wrap_search to 1, to allow searches to jump to the top after they have hit the bottom of all matches within a page.\n\nYou can set ignorecase_search to 1 to enable case insensitive searching.\n\n"
    },
    {
      "title": "Custom search engines",
      "level": 3,
      "content": "You can map keys to launch a CGI script that will capture your input and pass it onto a custom search engine, to do so first create a keybind inside ~/.w3m/keymap to launch your script:\n\n```\nkeymap s COMMAND \"SET_OPTION dictcommand=file:///cgi-bin/omnibar_google.cgi ; DICT_WORD\"\n```\n\nAnd place omnibar_google.cgi inside your ~/.w3m/cgi-bin directory and giving it execute permission.\n\nWhile the above script will return a Google result, you can use these kinds of scripts to search StackOverflow, GitHub, DuckDuckGo, Reddit and a bunch of other websites.\n\nYou can view similar scripts on GitHub.\n\n"
    },
    {
      "title": "Reader mode",
      "level": 3,
      "content": "Some webpages do not work well with w3m, be it because they use a lot of javascript or CSS to display most of their content. Very often you will have to scroll multiple pages just to get to the start of an article.\n\nThis can be mitigated by first passing the webpages through a reader mode program such as rdrview-gitAUR.\n\nTo do so add the following to ~/.w3m/keymap:\n\n```\nkeymap R COMMAND \"READ_SHELL 'rdrview $W3M_URL -H 2> /dev/null 1> /tmp/readable.html' ; LOAD /tmp/readable.html\"\n```\n\n"
    },
    {
      "title": "Redirect URLs",
      "level": 3,
      "content": "~/.w3m/siteconf file is used to set some preferences depending on the website, such as: referrer and user agent.\n\nIt can also be used to redirect to lighter (both in terms of layout and bandwidth), more privacy respecting alternatives to websites.\n\nIn addition to this it can also be used to run certain CGI scripts.\n\n```\n~/.w3m/siteconf\n```\n\n```\nurl m!^https?://([a-z]+\\.)?twitter\\.com/!\nsubstitute_url \"https://nitter.net/\"\n\nurl m!^https?://([a-z]+\\.)?reddit\\.com/!\nsubstitute_url \"https://safereddit.com/\"\n\n#url m!^https?://([a-z]+\\.)?google\\.com/!\n#substitute_url \"https://duckduckgo.com/lite/\"\n\nurl m!^https?://([a-z]+\\.)?imgur\\.com/!\nsubstitute_url \"https://rimgo.pussthecat.org/\"\n\nurl m!^https?://([a-z]+\\.)?wikipedia\\.com/!\nsubstitute_url \"https://wl.vern.cc/\"\n\nurl \"https://www.youtube.com/\" exact\nsubstitute_url \"file:/cgi-bin/video.cgi?\"\n#substitute_url \"https://yewtu.be/\"\n\nurl \"https://stackoverflow.com/\" exact\nsubstitute_url \"https://ao.bloatcat.tk/\"\n\nurl \"https://www.reuters.com/\" exact\nsubstitute_url \"https://neuters.de/\"\n\nurl \"https://fandom.com/\" exact\nsubstitute_url \"https://breezewiki.pussthecat.org/\"\n\nurl \"https://medium.com/\" exact\nsubstitute_url \"https://scribe.rip/\"\n\nurl \"https://web.archive.org/\" exact\nsubstitute_url \"https://wayback-classic.net/\"\n```\n\n"
    },
    {
      "title": "Restore closed windows",
      "level": 3,
      "content": "Default w3m cannot reopen closed tabs, this can be added by binding the close tab button to echo the current URL of the tab to be closed to a text file, and binding another key to restore the latest URL added to the file, using a CGI script.\n\nInside ~/.w3m/keymap add:\n\n```\nkeymap d COMMAND \"EXTERN 'echo %s >> ~/.w3m/RestoreTab.txt' ; CLOSE_TAB\"\nkeymap u COMMAND TAB_GOTO file:/cgi-bin/restore_tab.cgi\n```\n\nThen place the following file inside ~/.w3m/cgi-bin and make it executable.\n\nrestore_tab.cgi\n\n"
    },
    {
      "title": "Opening magnet links",
      "level": 3,
      "content": "magnet.cgi can be used to make w3m auto open magnet links using Transmission.\n\n"
    },
    {
      "title": "Using tor",
      "level": 4,
      "content": "You can use torify(1) to route w3m traffic through tor.\n\n```\n$ torify w3m -v\n```\n\n"
    },
    {
      "title": "User agent and headers",
      "level": 4,
      "content": "By default w3m uses its own user agent, meaning w3m users stand out amongst other users.\n\nFingerprint can be reduced by using a more generic user agent, language and http_accept header.\n\n```\n~/.w3m/config\n```\n\n```\nuser_agent Mozilla/5.0 (Windows NO 10.0; rev:91.0) Gecko/20100101 Firefox91.0\nno_referer 1\ncross_origin_referer 0\naccept_language en-US,en;q=0.5\naccept_encoding gzip, deflate\naccept_media text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n```\n\n"
    },
    {
      "title": "Disable cookies",
      "level": 4,
      "content": "To disable cookies set use_cookie to 0 in ~/.w3m/config.\n\n"
    },
    {
      "title": "Disable cache",
      "level": 4,
      "content": "To disable cache set no_cache to 1 in ~/.w3m/config.\n\n"
    },
    {
      "title": "Images flickering/causing lag",
      "level": 3,
      "content": "Unfortunately, sometimes w3m lags when trying to scroll past an image, to the point where the browser can become unresponsive for multiple seconds.\n\nA solution to this is outright disabling images, but this breaks some websites (for example, hacker news relies on GIFs for comment indentation).\n\nA more elegant solution would be to make a keybind to toggle images on or off, to do so add the following line to ~/.w3m/keymap:\n\n```\nkeymap i COMMAND \"SET_OPTION display_image=toggle ; RESHAPE\"\n```\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Homepage\n- Github repository\n- w3m.rocks\n- A vim-like configuration for w3m\n- w3m plugins\n\n"
    }
  ]
}