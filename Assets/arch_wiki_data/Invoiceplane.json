{
  "title": "Invoiceplane",
  "url": "https://wiki.archlinux.org/title/Invoiceplane",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "InvoicePlane is a self-hosted open source application for managing your quotes, invoices, clients and payments.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the invoiceplaneAUR package.\n\n"
    },
    {
      "title": "Database",
      "level": 3,
      "content": "Here is an example on how you could setup a database for Invoiceplane with MariaDB called invoiceplane for the user invoiceplane identified by the password password:\n\n```\nCREATE DATABASE invoiceplane;\nGRANT ALL PRIVILEGES ON invoiceplane.* TO invoiceplane@'localhost' IDENTIFIED BY 'password';\nFLUSH PRIVILEGES;\n```\n\n"
    },
    {
      "title": "Apache",
      "level": 4,
      "content": "Create the Apache HTTP Server configuration file:\n\n```\n/etc/httpd/conf/extra/invoiceplane.conf\n```\n\n```\nAlias /invoiceplane \"/usr/share/webapps/invoiceplane\"\n<Directory \"/usr/share/webapps/invoiceplane\">\n    DirectoryIndex index.php\n    AllowOverride All\n    Options FollowSymlinks\n    Require all granted\n</Directory>\n```\n\nAnd include it in /etc/httpd/conf/httpd.conf:\n\n```\n# InvoicePlane configuration\nInclude conf/extra/invoiceplane.conf\n```\n\n"
    },
    {
      "title": "Lighttpd",
      "level": 4,
      "content": "Make an alias for invoiceplane in your Lighttpd configuration.\n\n```\nalias.url = ( \"/invoiceplane\" => \"/usr/share/webapps/invoiceplane/\")\n```\n\nThen enable mod_alias, mod_fastcgi and mod_cgi in the server.modules section.\n\n"
    },
    {
      "title": "nginx",
      "level": 4,
      "content": "Here is an example configuration to include in nginx.conf for a subdomain with php-fpm:\n\n```\n/etc/nginx/sites-available/invoiceplane.conf\n```\n\n```\nserver {\n\nlisten 443 ssl http2;\nlisten [::]:443 ssl http2;\n\n        add_header X-Frame-Options \"SAMEORIGIN\";\n\n        root /usr/share/webapps/invoiceplane;\n        index index.php;\n                                                                                                       \n        server_name invoice.''domain.tld'';\n\n        client_body_timeout 60;\n\n    location / {\n        try_files $uri $uri/ /index.php?q=$uri&$args;       \n    }\n\n    location ~ \\.php$ {\n        fastcgi_param PHP_ADMIN_VALUE open_basedir=/tmp:/usr/share/webapps/invoiceplane:/dev/urandom:/usr/share/php;\n        fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n        fastcgi_param DOCUMENT_ROOT $realpath_root;\n        fastcgi_param PATH_INFO $fastcgi_path_info;\n        fastcgi_pass unix:/run/php-fpm/php-fpm.sock;\n        client_max_body_size 100M;\n    }\n}\n```\n\n"
    },
    {
      "title": "Explicitly permit InvoicePlane directories for php-fpm",
      "level": 3,
      "content": "Since version 7.4 php-fpm is hardened per default and revokes read/write access on /usr (and sub-directories). Therefore it is also necessary to explicitly give permissions on /usr/share/webapps/invoiceplane directories.\n\nCreate a drop-in file for php-fpm.service.\n\nAdd and save it with the following content:\n\n```\n/etc/systemd/system/php-fpm.service.d/override.conf\n```\n\n```\n[Service]\nReadWritePaths = /usr/share/webapps/invoiceplane/ipconfig.php\nReadWritePaths = /usr/share/webapps/invoiceplane/uploads/\nReadWritePaths = /usr/share/webapps/invoiceplane/application/logs\nReadWritePaths = /usr/share/webapps/invoiceplane/vendor/mpdf/mpdf/tmp\n```\n\nAfterwards restart the php-fpm service and assign write permissions to the http user.\n\n"
    },
    {
      "title": "Installation wizard",
      "level": 3,
      "content": "Once database and webserver have been setup, visit the installation wizard page at http://your-invoiceplane-domain.com/index.php/setup and follow the instructions.\n\n"
    },
    {
      "title": "Localization",
      "level": 2,
      "content": "If you want to choose a different language than English visit Translation / Localization.\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Official web page\n- Documentation\n\n"
    }
  ]
}