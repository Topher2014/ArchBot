{
  "title": "Pure-FTPd",
  "url": "https://wiki.archlinux.org/title/Pure-FTPd",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- SFTP chroot\n- SCP and SFTP\n\nPure-FTPd is an FTP server designed with security in mind.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "pure-ftpdAUR can be installed from the Arch User Repository.\n\nStart and enable pure-ftpd.service.\n\n"
    },
    {
      "title": "Configuration",
      "level": 2,
      "content": "Pure-FTPd configuration is completely done with its startup arguments.\n\nThere is a wrapper script, which reads /etc/pure-ftpd/pure-ftpd.conf. It then starts Pure-FTPd with the corresponding arguments.\n\n"
    },
    {
      "title": "Set up virtual users",
      "level": 3,
      "content": "With Pure-FTPd, it is possible to use virtual users instead of real system users.\n\nThe available users need to be provided by one or more backends. See backends.\n\nFor simplicity and demonstration purposes, the PureDB backend will be used. Uncomment the following two lines:\n\n```\n/etc/pure-ftpd/pure-ftpd.conf\n```\n\n```\n# We disable the anonymous account.\nNoAnonymous yes\n# We use PureDB as backend and specify its path.\nPureDB /etc/pureftpd.pdb\n```\n\nNow only authenticated users can connect. To add users to the PureDB we need to create a /etc/passwd-like file which is then used to create the PureDB.\n\nTo create, view, or modify the /etc/pureftpd.passwd file, we use the pure-pw command.\n\n```\n# pure-pw useradd someuser -u ftp -d /srv/ftp\n```\n\nThis creates the user someuser which runs as the FTP system user. By default, the user is chrooted to /srv/ftp. In the event that that's undesirable, replace -d with -D.\n\nNote: The virtual users running as the FTP system users can not log in by default. To change that behavior, set the option MinUID in /etc/pure-ftpd.conf to 14 (UID of the ftp user).\n\nThe virtual users running as the FTP system users can not log in by default. To change that behavior, set the option MinUID in /etc/pure-ftpd.conf to 14 (UID of the ftp user).\n\nWe also need to list the shell of the FTP system user in /etc/shells.\n\n```\n# echo \"/bin/false\" >> /etc/shells\n```\n\nBefore this account is usable, we need to commit our changes:\n\n```\n# pure-pw mkdb\n```\n\nThe virtual user can now access everything in /srv/ftp.\n\nThe command pure-pw mkdb creates the file mentioned earlier called /etc/pureftpd.pdb, which houses all information related to your virtual users. There is no need to restart your service when issuing this command as it is updated on the fly and changes take effect immediately.\n\n"
    },
    {
      "title": "Changing user password",
      "level": 4,
      "content": "For example, to change a user's password, type the command:\n\n```\n# pure-pw passwd someuser\n```\n\nAfterwards, commit your changes by updating /etc/pureftpd.pdb:\n\n```\n# pure-pw mkdb\n```\n\n"
    },
    {
      "title": "Removing user",
      "level": 4,
      "content": "To remove a user, type the command:\n\n```\n# pure-pw userdel someuser\n```\n\nThe user's home directory is not removed via this command; therefore, it must be removed manually.\n\n"
    },
    {
      "title": "Checking user settings",
      "level": 4,
      "content": "To check a user's current account settings, type the command:\n\n```\n# pure-pw show someuser\n```\n\n"
    },
    {
      "title": "Backends",
      "level": 3,
      "content": "You need to specify one or more backends. If you specify more than one, Pure-FTPd will respect the order in which they are specified. It will use the first backend which contains the requested user.\n\nAvailable backends are:\n\n- /etc/passwd\n- MySQL\n- LDAP\n- PostgreSQL\n- PAM\n- PureDB\n- Or you can write your own\n\n"
    },
    {
      "title": "PAM",
      "level": 4,
      "content": "To enable PAM backend, create the following file:\n\n```\n/etc/pam.d/pure-ftpd\n```\n\n```\nauth       required     pam_unix.so\nauth       required     pam_env.so\naccount    required     pam_unix.so\nsession    required     pam_unix.so\n```\n\nand uncomment the PAMAuthentication line in the config file like so:\n\n```\n/etc/pure-ftpd/pure-ftpd.conf\n```\n\n```\n# If you want to enable PAM authentication, uncomment the following line\n\nPAMAuthentication            yes\n```\n\n"
    },
    {
      "title": "Create a certificate",
      "level": 4,
      "content": "Refer to the documentation for more information. The short version is this:\n\nCreate a Self-Signed Certificate:\n\n```\n# mkdir -p /etc/ssl/private\n# openssl req -x509 -nodes -days 7300 -newkey rsa:2048 -sha256 -keyout /etc/ssl/private/pure-ftpd.pem -out /etc/ssl/private/pure-ftpd.pem\n```\n\nMake it private:\n\n```\n# chmod 600 /etc/ssl/private/*.pem\n```\n\n"
    },
    {
      "title": "Enable TLS",
      "level": 4,
      "content": "Towards the bottom of /etc/pure-ftpd/pure-ftpd.conf you should find a section for TLS. Uncomment and change the TLS setting to 1 to enable both FTP and FTPS:\n\n```\n/etc/pure-ftpd/pure-ftpd.conf\n```\n\n```\nTLS             1\n```\n\nNow restart the pure-ftpd.service unit and you should be able to log in with FTPS-capable clients, e.g. filezilla or SmartFTP.\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Official homepage\n- Virtual users\n\n"
    }
  ]
}