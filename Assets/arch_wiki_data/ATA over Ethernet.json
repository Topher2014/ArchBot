{
  "title": "ATA over Ethernet",
  "url": "https://wiki.archlinux.org/title/ATA_over_Ethernet",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "From Wikipedia:ATA over Ethernet:\n\n"
    },
    {
      "title": "Prequisites to ATA over Ethernet",
      "level": 2,
      "content": "To use AOE, install vbladeAUR and aoetoolsAUR.\n\nAoE does not use IPv4/IPv6; it works directly on top of Ethernet and is limited to the local subnet. It is enough to make sure that the interface is up. (For best performance, the subnet should use jumbo frames.)\n\n```\n# ip link set eth0 up\n```\n\n"
    },
    {
      "title": "Target: Export a disk",
      "level": 2,
      "content": "You can export block devices or image files using vblade or the vbladed daemon.\n\nCreate an empty disk image:\n\n```\n# dd if=/dev/zero of=vblade0 bs=1M count=256\n```\n\nStart vblade to export the disk over eth0:\n\n```\n# vblade 1 1 eth0 vblade0\n```\n\nExported disks are identified by their \"shelf ID\" and \"slot ID\" (within that shelf), in this case 1.1; the combination must be unique across the SAN.\n\n"
    },
    {
      "title": "Initiator: Attach to a disk",
      "level": 2,
      "content": "Ensure the kernel module is loaded:\n\n```\n# modprobe aoe\n```\n\nBy default, all interfaces are used, but you can specify a whitelist either as aoe module parameter, or using the aoe-interfaces command:\n\n```\n# aoe-interfaces eth0\n```\n\nThe kernel module performs periodic discovery; to do it immediately (e.g. after changing interfaces), use aoe-discover. Afterwards, use aoe-stat to list \"visible\" disks.\n\n```\n# aoe-discover\n# aoe-stat\n     e1.1         0.001GB   eth0 up\n```\n\nThe first column shows a device name which also can be found under /dev/etherd as a regular block device. You can partition it with fdisk, or just create a file system:\n\n```\n# mkfs.ext4 /dev/etherd/e1.1\n# mkdir /mnt/e1.1\n# mount /dev/etherd/e1.1 /mnt/e1.1\n```\n\n"
    }
  ]
}