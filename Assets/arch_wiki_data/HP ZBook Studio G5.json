{
  "title": "HP ZBook Studio G5",
  "url": "https://wiki.archlinux.org/title/HP_ZBook_Studio_G5",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **This article or section does not follow the Laptop page guidelines.** This article or section does not follow the Laptop page guidelines.\n\nThis article or section does not follow the Laptop page guidelines.\n\nTable content:\nHardware | PCI/USB ID | Working?\nTouchpad |  | Yes\nKeyboard |  | Partial\nWebcam | 05c8:0808 | Yes\nBacklight |  | Yes\nBluetooth | 8087:0aaa | Yes\nSD-Card slot | 10ec:525a | Yes\nAudio | 8086:a348 | Yes\nHDMI audio | 10de:0fb9 | Yes\nWireless | 8086:a370 | Yes\nFingerprint reader | 138a:00ab | No\n\nThe HP Zbook Studio G5 is a workstation replacement laptop.\n\n"
    },
    {
      "title": "Thunderbolt",
      "level": 3,
      "content": "Since the Zbook does not allow a no security option for Thunderbolt in the BIOS, a Thunderbolt manager has to be installed see bolt.\n\n"
    },
    {
      "title": "Nouveau",
      "level": 3,
      "content": "This laptop works out of the box with nouveau graphics from the latest kernel, including HDMI audio. The performance is worse than with Nvidia drivers, which is especially noticeable in video decoding. Frames might get dropped when trying to stream 1080p videos, depending on the bitrate. The biggest issue, though, is that when the laptop has been connected to an external monitor, the shutdown does not complete and you have to force shutdown.\n\n"
    },
    {
      "title": "Nvidia drivers",
      "level": 3,
      "content": "The proprietary Nvidia drivers work flawlessly on this laptop. This driver also has better performance than the nouveau driver, but for Wayland users using this driver is not an option (yet).\n\n"
    },
    {
      "title": "BIOS settings",
      "level": 3,
      "content": "In the BIOS you can choose between three different modes: \"Discrete\", \"Hybrid\" and \"UMA graphics\" (Intel Graphics), referring to which GPU('s) to turn on. The option \"Hybrid\" works well, but if you are experiencing issues with graphics performance you can try setting the \"Discrete\" option to disable the integrated GPU. This does come at the expense of the battery life.\n\n"
    },
    {
      "title": "External monitors",
      "level": 3,
      "content": "The HDMI port is routed to the Nvidia GPU and the internal display is routed to the internal Intel GPU. To use the HDMI output the Nvidia driver or nouveau has to be installed. There are two ways to use the USB-C ports as display outputs:\n\n- Disable the Nvidia graphics in the BIOS setup (Advanced > Built-in device options > Graphics > UMA graphics). This allows the user to use the USB-C port as display output without the Nvidia graphics and without additional configuration. The HDMI port will be disabled in this mode.\n- Use the \"Hybrid\" setting in the BIOS and configure Bumblebee as described below. This method allows the user to either use the HDMI port or the USB-C ports for display output purposes.\n\n"
    },
    {
      "title": "Bumblebee",
      "level": 3,
      "content": "To make use of both the onboard graphics and the Nvidia GPU, install bumblebee (and add user to bumblebee user group and start bumblebeed.service). For an output on the ports connected to the Nvidia chip, the chip always needs to be powered on. To do this change the following options:\n\n```\n/etc/bumblebee/bumblebee.conf\n```\n\n```\nKeepUnusedXServer=true\n[driver-nvidia]\nPMMethod=none\n```\n\nThis prevents the NVIDIA chip from powering off after turning on. Next edit the following:\n\n```\n/etc/xorg.conf.d/20-nvidia.conf\n```\n\n```\nSection \"Device\"\n        Identifier \"Nvidia Card\"\n        Driver \"nvidia\"\n        Option \"AutoAddDevices\" \"true\"\n        Option \"UseEDID\" \"true\"\n        Option \"AllowEmptyInitialConfiguration\"\n        #Option \"UseDisplayDevice\" \"none\"\n    EndSection\n```\n\nNext a virtual output needs to be added to the Intel GPU. Edit or create an entry for the Intel GPU:\n\n```\n/etc/X11/xorg.conf.d/20-intel.conf\n```\n\n```\nSection \"Device\"\n        Identifier \"intelgpu0\"\n        Driver \"intel\"\n        Option \"VirtualHeads\" \"1\"\n    EndSection\n```\n\nThat is all the configuration, now to enable external monitor:\n\n```\n$ optirun true\n $ intel-virtual-output\n```\n\nIt is recommended to put this in a script and create a desktop entry or similar to quickly enable the external display(s).\n\n"
    },
    {
      "title": "CPU throttling down under load",
      "level": 3,
      "content": "If your CPU throttles down under high load without reaching critical temperatures (e.g. >95Â°C) and you are absolutely sure the laptop is not overheating, install the throttled package by erpalma on GitHub. Start/enable throttled.service.\n\nThis service overrides the package power limit every 5 seconds (30 on battery) by overriding default values in MSR and MCHBAR. A static fix for this problem has not been tested thoroughly. The default configuration works fine, refer to the GitHub page for more information.\n\n"
    },
    {
      "title": "Framerate drops to 1 fps on discrete graphics",
      "level": 3,
      "content": "Refer to the Bumblebee troubleshooting page.\n\n"
    },
    {
      "title": "Framerate drops to 1 fps when using external display",
      "level": 3,
      "content": "In certain applications, eg. Discord, Zoom and Steam, the fps drops to an unusable level when connected to an external display. This is an issue with vsync not working correctly. Try to disable vsync on the intgrated GPU. If that does not work you can try to disable vsync on the dGPU.\n\n"
    },
    {
      "title": "Microphone not detected",
      "level": 3,
      "content": "If your internal microphone is not detected on boot you can force PulseAudio to detect it. See PulseAudio/Troubleshooting#Microphone not detected by PulseAudio.\n\n"
    },
    {
      "title": "Brightness keys do not work",
      "level": 3,
      "content": "On some BIOS versions some of your functions keys, namely the brightness up, down and microphone mute keys, produce identical scan codes. You can try to update your BIOS to fix this. See [1] for the bug report. If this does not work you can try to perform a power reset (see [2]). This problem seems to be related to the HP Hotkey Service in Windows, that changes how the keys are handled (see [3]), so after you boot to Windows it might reappear.\n\n"
    },
    {
      "title": "No sound output from two front speakers",
      "level": 3,
      "content": "Out of the box there is no sound output from the two front speakers. To solve this, use hdajackretask and change the following:\n\n- Under codec > Conexant CX11970, press Show unconnected pins, and change for pin 0x17 the status to Override and set Internal speaker (LFE).\n- Then press Install boot override and reboot.\n- After this, specify Analog Surround 4.0 Output in sound settings.\n\n"
    }
  ]
}