{
  "title": "Consolekit",
  "url": "https://wiki.archlinux.org/title/Consolekit",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- PolicyKit\n\nConsoleKit2 is a framework for defining and tracking users, login sessions, and seats. Its function is to support multiuser setups. It also works for a single user, but offers no benefits compared to existing methods. [3]\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the consolekitAUR and polkit-consolekitAUR packages.\n\n"
    },
    {
      "title": "ck-launch-session",
      "level": 3,
      "content": "To launch an X session with ConsoleKit, append the following to the exec statement in ~/.xinitrc e.g.:\n\n```\nexec ck-launch-session dbus-launch --sh-syntax --exit-with-session openbox-session\n```\n\nThis starts Openbox with proper environment variables so it and its children are able to use ConsoleKit.\n\nDisplay managers like GDM, LXDM and SLiM start ConsoleKit automatically with each X session.\n\n- Do not nest ConsoleKit sessions by calling one from another, or you will break ConsoleKit.\n- In particular, since SLiM reads ~/.xinitrc, you should make sure not to run ck-launch-session there.\n\n"
    },
    {
      "title": "No display manager",
      "level": 3,
      "content": "If you are not using a display manager, but starting your window manager via the startx command, or from inittab.\n\nIf ConsoleKit is not working (ck-list-sessions command showing active = FALSE), you should start your window manager using the bash_profile method: Xinit#Autostart X at login.\n\n"
    },
    {
      "title": "Desktop environments",
      "level": 3,
      "content": "LightDM can be used as a login manager.\n\n"
    },
    {
      "title": "Use D-Bus for power operations",
      "level": 3,
      "content": "Note: **The factual accuracy of this article or section is disputed.** The factual accuracy of this article or section is disputed.\n\nThe factual accuracy of this article or section is disputed.\n\nShut down:\n\n```\ndbus-send --system --print-reply --dest=\"org.freedesktop.ConsoleKit\" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Stop\n```\n\nRestart:\n\n```\ndbus-send --system --print-reply --dest=\"org.freedesktop.ConsoleKit\" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Restart\n```\n\nSuspend:\n\n```\ndbus-send --system --print-reply --dest=\"org.freedesktop.ConsoleKit\" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Suspend  boolean:true\n```\n\nHibernate (suspend to disk):\n\n```\ndbus-send --system --print-reply --dest=\"org.freedesktop.ConsoleKit\" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Hibernate  boolean:true\n```\n\nHybrid Sleep (suspend + hibernate):\n\n```\ndbus-send --system --print-reply --dest=\"org.freedesktop.ConsoleKit\" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.HybridSleep  boolean:true\n```\n\nThis method assumes that you are given permission to shut the system down via PolicyKit. The default group for this is wheel. To change this, edit /etc/polkit-1/localauthority.conf.d/50-localauthority.conf as root.\n\n"
    },
    {
      "title": "Running several applications from ~/.xinitrc",
      "level": 3,
      "content": "If several applications are to be executed from ~/.xinitrc, not all of these will have ConsoleKit environment variables set. In the following example, only children of Compiz will be able to properly use ConsoleKit, but children of xterm will not.\n\n```\n~/.xinitrc\n```\n\n```\nxterm &\nexec ck-launch-session compiz ccp\n```\n\nTypically, this can be an issue when for example using Compiz standalone and some other application launchers, (gnome-do, kupfer, gmrun, xbindkeys, etc.) since children of the application launcher will not be able to use ConsoleKit. A dirty workaround is to have the entire session started by a second script, e.g. ~/.xstart. Do not forget dbus-launch, it is likely that you will need it too:\n\n```\n~/.xinitrc\n```\n\n```\nexec ck-launch-session dbus-launch ~/.xstart\n```\n\n```\n~/.xstart\n```\n\n```\nxterm &\nthunar &\ncompiz ccp\n```\n\nDo not forget to make ~/.xstart executable.\n\nTo see whether everything is started correctly:\n\n```\n$ ck-list-sessions\n```\n\nIt should show at least one session like this one:\n\n```\nSession18:\n       unix-user = '1000'\n       realname = 'Your Name'\n       seat = 'Seat1'\n       session-type = \n       active = TRUE\n       x11-display = ':0'\n       x11-display-device = '/dev/tty2'\n       display-device = '/dev/tty1'\n       remote-host-name = \n       is-local = TRUE\n       on-since = '2011-11-16T12:01:50.104764Z'\n       login-session-id = '7'\n```\n\n"
    },
    {
      "title": "Consolekit blocks active TTY",
      "level": 3,
      "content": "Configure init to start ConsoleKit on an unused TTY, for example:\n\n```\n/usr/bin/openvt -c 63 -f -- /usr/sbin/console-kit-daemon --no-daemon &\n```\n\nSee [4] for details.\n\n"
    },
    {
      "title": "Inactive session when launching X on same TTY",
      "level": 3,
      "content": "Specify the keeptty flag to startx or xinit [5], for example:\n\n```\nstartx -- -keeptty\n```\n\nSee also Xorg#Session log redirection.\n\n"
    },
    {
      "title": "Replacing ConsoleKit with systemd-logind",
      "level": 2,
      "content": "Remove references to ck-launch-session from ~/.xinitrc.\n\nSee Session to check the status of your user session.\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- ck-launch-session, Compiz, and mounting in Thunar/udisks\n- Gentoo wiki\n\n"
    }
  ]
}