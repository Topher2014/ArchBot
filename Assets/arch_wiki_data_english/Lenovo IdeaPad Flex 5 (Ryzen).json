{
  "title": "Lenovo IdeaPad Flex 5 (Ryzen)",
  "url": "https://wiki.archlinux.org/title/Lenovo_IdeaPad_Flex_5_(Ryzen)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **This article or section does not follow the Laptop page guidelines.** This article or section does not follow the Laptop page guidelines.\n\nThis article or section does not follow the Laptop page guidelines.\n\nTable content:\nHardware | PCI/USB ID | Working?\nBluetooth | 0bda:c123 | Yes\nWebcam | 174f:243f | Yes\nWireless | 10ec:c822 | Yes\nGPU | 1002:1636 | Yes\nTouchpad |  | Yes\nTouchscreen |  | Yes\nFingerprint reader(Egis) |  | Untested\nFingerprint reader(Goodix) | 27c6:55b4 | Untested\nFingerprint reader(Synaptics) | 06cb:00be | Yes\nSD card reader | 10ec:522a | Yes\nAudio | 1022:15e3 | Yes\nAccelerometer |  | Yes\n\nThe Lenovo IdeaPad Flex 5 14ARE05 is a convertible 2-in-1 laptop computer with a 14\" screen, AMD Ryzenâ„¢ 3/5/7 4000 U-Series Processor, 4GB/8GB/16GB of memory, webcam, microphone, stereo speakers, headphone / microphone combo jack, 802.11ac wireless card with Bluetooth 5.0, 1 x USB-C 3.2 Gen 1 Type-C(supports charging), 2 x USB 3.2 Gen 1 Type-A, 1 x SD card reader, 1 x HDMI 1.4b, 1 x power connector, and a fingerprint reader.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Before installing, disable Secure Boot in the BIOS. You can access the BIOS by pressing F2 during boot. The boot menu can also be accessed by pressing F12.\n\n"
    },
    {
      "title": "Accessibility",
      "level": 2,
      "content": "Note: **This article or section needs expansion.** This article or section needs expansion.\n\nThis article or section needs expansion.\n\n"
    },
    {
      "title": "Issues",
      "level": 2,
      "content": "- HDMI sound suffers from the PulseAudio bug described in PulseAudio/Examples#HDMI output configuration. The workaround described there works (manually setting the module-alsa-sink device in /etc/pulse/default.pa).\n- Errors with pointer devices when flipping/rotating the screen manually with randr.\n- In kernel 5.12 keyboard backlight support was added to the ideapad_laptop kernel module but it does not seem to properly support the multiple keyboard backlight brightnesses provided by the keyboad (off|dim|bright). This can cause problems setting keyboard brightness with software.\n- Occasionally the touchscreen and touchpad do not work after boot. The workaround for this a reboot. The cause and fix is unknown. The dmesg log is below:\n\n```\n[   15.619747] i2c_hid_acpi i2c-WACF2200:00: HID over i2c has not been provided an Int IRQ\n[   15.619776] i2c_hid_acpi i2c-MSFT0001:00: HID over i2c has not been provided an Int IRQ\n[   15.619809] i2c_hid_acpi: probe of i2c-WACF2200:00 failed with error -22\n[   15.619846] i2c_hid_acpi: probe of i2c-MSFT0001:00 failed with error -22\n```\n\n- The Synaptics 06cb:00be fingerprint sensor is not supported out of the box by libfprint. To work around this, you can use libfprint-2-tod1-synatudor-gitAUR along with libfprint-tod-gitAUR, to get this fingerprint reader working.\n\n"
    },
    {
      "title": "Touch screen setup",
      "level": 2,
      "content": "The touchscreen and pen is recognized by the input-wacom driver. For setup information look at Wacom.\n\n"
    },
    {
      "title": "Tablet/Laptop mode",
      "level": 2,
      "content": "Install yoga-usage-mode-dkms-gitAUR to get device recognition for the lid switch. This creates the device /dev/input/by-path/platform-yoga-event, on which libinput or detect-tablet-mode-gitAUR can act.\n\n"
    },
    {
      "title": "Power management options",
      "level": 2,
      "content": "Note: **This article or section is a candidate for merging with Laptop/Lenovo#Lenovo.** This article or section is a candidate for merging with Laptop/Lenovo#Lenovo.\n\nThis article or section is a candidate for merging with Laptop/Lenovo#Lenovo.\n\n"
    },
    {
      "title": "Rapid charge",
      "level": 3,
      "content": "First install acpi_call (or acpi_call-lts for LTS kernel, acpi_call-dkms for other kernels) and load the kernel module:\n\n```\n# modprobe acpi_call\n```\n\nTurn on:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x07' > /proc/acpi/call\n```\n\nTurn off:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x08' > /proc/acpi/call\n```\n\n"
    },
    {
      "title": "Battery conservation mode",
      "level": 3,
      "content": "This device supports battery conservation mode.\n\n"
    },
    {
      "title": "Kernel method",
      "level": 4,
      "content": "Turn on:\n\n```\n# echo 1 > /sys/bus/platform/drivers/ideapad_acpi/VPC2004:00/conservation_mode\n```\n\nTurn off:\n\n```\n# echo 0 > /sys/bus/platform/drivers/ideapad_acpi/VPC2004:00/conservation_mode\n```\n\n"
    },
    {
      "title": "ACPI method",
      "level": 4,
      "content": "First install acpi_call (or acpi_call-lts for LTS kernel, acpi_call-dkms for other kernels) and load the kernel module:\n\n```\n# modprobe acpi_call\n```\n\nTurn on:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x03' > /proc/acpi/call\n```\n\nTo verify your setting run the command below, you should get 1:\n\n```\n$ cat /sys/bus/platform/drivers/ideapad_acpi/VPC2004:00/conservation_mode\n```\n\nTurn off:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.SBMC 0x05' > /proc/acpi/call\n```\n\nTo verify your setting run the command below, you should get 0:\n\n```\n$ cat /sys/bus/platform/drivers/ideapad_acpi/VPC2004:00/conservation_mode\n```\n\n"
    },
    {
      "title": "System performance mode",
      "level": 3,
      "content": "There are 3 modes available: Intelligent Cooling, Extreme Performance and Battery Saving.\n\n"
    },
    {
      "title": "Kernel method",
      "level": 4,
      "content": "To list available options run the command below:\n\n```\n$ cat /sys/firmware/acpi/platform_profile_choices\n```\n\n```\nlow-power balanced performance\n```\n\nSet it to Intelligent Cooling mode:\n\n```\n# echo 'balanced' > /sys/firmware/acpi/platform_profile\n```\n\nSet it to Extreme Performance mode:\n\n```\n# echo 'performance' > /sys/firmware/acpi/platform_profile\n```\n\nSet it to Battery Saving mode:\n\n```\n# echo 'low-power' > /sys/firmware/acpi/platform_profile\n```\n\n"
    },
    {
      "title": "ACPI method",
      "level": 4,
      "content": "First install acpi_call (or acpi_call-lts for LTS kernel, acpi_call-dkms for other kernels) and load the kernel module:\n\n```\n# modprobe acpi_call\n```\n\nSet it to Intelligent Cooling mode:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.DYTC 0x000FB001' > /proc/acpi/call\n```\n\nSet it to Extreme Performance mode:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.DYTC 0x0012B001' > /proc/acpi/call\n```\n\nSet it to Battery Saving mode:\n\n```\n# echo '\\_SB.PCI0.LPC0.EC0.VPC0.DYTC 0x0013B001' > /proc/acpi/call\n```\n\n"
    },
    {
      "title": "Firmware",
      "level": 2,
      "content": "fwupd does not officially support this device but it can still be used to apply uefi firmware updates.[1]\n\n"
    },
    {
      "title": "Updating bios",
      "level": 3,
      "content": "- All bios settings will be reset including the boot entry so make sure you can set up the boot entry for your install after the bios update. See efibootmgr for more information.\n- The commands fwupdate -l and fwupdate -i may no longer work (error below), but fwupdate -a still works.\n\n```\n(fwupdate:10680): FuPluginUefiCapsule-WARNING **: 12:47:47.256: SMBIOS BIOS Characteristics Extension Byte 2 is invalid -- UEFI Specification is unsupported, but /sys/firmware/efi exists: SMBIOS not supported\nSegmentation fault (core dumped)\n```\n\n"
    },
    {
      "title": "Pre update",
      "level": 4,
      "content": "- Install the innoextract, udisks2 and fwupd packages.\n- Download bios update exe file.[2]\n\n"
    },
    {
      "title": "Procedure",
      "level": 4,
      "content": "Run the following commands:\n\n- Extract the bios .cap file:\n\n```\n$ innoextract file.exe\n```\n\n- Get the GUID number of your system firmware for the next step. You should get something that looks like example below:\n\n```\n# fwupdmgr get-devices\n```\n\n```\nsystem-firmware type, {e20bafd3-9914-4f4f-9537-3129e090eb3c} version 22315982 can be updated to any version above 22315981\ndevice-firmware type, {e3be8073-66a6-4bf6-966a-c0d58b486c40} version 1 can be updated to any version above 0\ndevice-firmware type, {c85ba1bc-54a7-4aab-9337-eed4746bf09f} version 0 can be updated to any version above 4294967295\n```\n\n- Schedule the update for the next system reboot, using extracted .cap file:\n\n```\n# fwupdtool install-blob /path/to/file.cap e20bafd3-9914-4f4f-9537-3129e090eb3c\n```\n\n- Reboot if there are no errors.\n- Enter the bios settings and move Linux-Firmware-Updater to the first option in the Boot Priority Order menu.\n- Save and exit and the update should begin.\n\n- When the update completes it will boot into the boot menu. At this point it is safe to interact with the device again.\n\n"
    },
    {
      "title": "Post update",
      "level": 4,
      "content": "- Disable secure boot in the settings to be able to boot into Linux.\n- If your boot loader is not detected, boot into a usb with Arch and use arch-chroot to reinstall your boot loader or use efibootmgr to create a boot entry.\n\n"
    },
    {
      "title": "Secure boot",
      "level": 3,
      "content": "This device supports custom importing keys using efi-updatevar(efitools).\n\n"
    },
    {
      "title": "Lenovo diagnostics",
      "level": 3,
      "content": "The Lenovo diagnostics can be accessed by pressing F11 during boot. The Diagnostics contains tests for the motherboard and memory. Results of the tests can be stored onto a USB stick.\n\n"
    },
    {
      "title": "AMD PSP",
      "level": 4,
      "content": "The AMD Platform Security Processor setting in the firmware can be used to disable or enable TPM functionality.\n\n"
    },
    {
      "title": "Disable built-in battery",
      "level": 4,
      "content": "This option temporarily disables the battery for servicing(e.g. changing ssd). To enable the battery again, connect the charger to the device.\n\n"
    },
    {
      "title": "Accessing the bios",
      "level": 3,
      "content": "The firmware settings and boot menu can be accessed by pressing the novo button(located on the right side of the headphone jack) with a pin or paperclip when the device powered off.\n\n"
    },
    {
      "title": "Power management in firmware",
      "level": 3,
      "content": "The System Performance Mode Option can be set to Extreme Performance, Intelligent Cooling, Battery Conservation. These settings can also be controlled from the OS, see #System performance mode.\n\n"
    },
    {
      "title": "OneKeyBattery bug",
      "level": 4,
      "content": "There is a bug with the OneKeyBattery setting which can cause problems powering on the device. It effects bios versions older than eecn25ww. To fix this, disable the OneKeyBattery setting in the bios or update the bios to version eecn25ww or newer.\n\n"
    },
    {
      "title": "Function keys",
      "level": 2,
      "content": "Note: **This article or section does not follow the Laptop page guidelines.** This article or section does not follow the Laptop page guidelines.\n\nThis article or section does not follow the Laptop page guidelines.\n\n- Keys marked as visible should contain what key they appear as in xev/wev.\n- \"Does weird things\" is unhelpful to other readers\n\nTable content:\nKey | Visible?1 | Marked?2 | Effect\nFn+Esc | Yes | Yes | Enables Fn lock\nF1 | Yes | Yes | XF86AudioMute\nF2 | Yes | Yes | XF86AudioLowerVolume\nF3 | Yes | Yes | XF86AudioRaiseVolume\nF4 | Yes | Yes | XF86AudioMicMute\nF5 | Yes | Yes | XF86MonBrightnessDown\nF6 | Yes | Yes | XF86MonBrightnessUp\nF7 | Yes | Yes | Super+p\nF8 | Yes3 | Yes | XF86RFKill\nF9 | Yes | Yes | Super+i\nF10 | Yes | Yes | Super+l\nF11 | Yes | Yes | Ctrl+Alt+Tab\nF12 | Yes | Yes | XF86Calculator\nIns | No | Yes | Opens Lenovo Vantage on Windows wich is not usable on Linux, even that, it does weird things.\nPrintScreen | Yes | Yes | Super+Shift+s\nFn+Space | No | Yes | Changes keyboard backlight brightness\nFn+q | Yes | No | XF86Launch4\nFn+s | Yes | No | PrintScreen\nFn+b | Yes | No | BreakPause\nFn+Left | Yes | Yes | Home\nFn+Right | Yes | Yes | End\nFn+Up | Yes | Yes | PageUp\nFn+Down | Yes | Yes | PageDown\n\n1. The key is visible to xev and similar tools.\n1. The physical key has a symbol on it, which describes its function.\n1. systemd-logind handles this by default.\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Product Specifications Reference (PSREF)\n- List of all IdeaPad Flex 5 14ARE05 models\n- Hardware maintenance manual\n- User guide\n\n"
    }
  ]
}