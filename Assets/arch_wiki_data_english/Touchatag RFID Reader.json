{
  "title": "Touchatag RFID Reader",
  "url": "https://wiki.archlinux.org/title/Touchatag_RFID_Reader",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Touchatag is a RFID tag reader from Touchatag. It is a cheap set consisting of an ACR122U USB tag reader and MiFare Ultralight RFID tags (USB ID 072f:2200, use lsusb -v to check the firmware version − 2.14 as of 2020-05-10 − under the bcdDevice descriptor).\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Stop the conflicting drivers (nfc, pn533 and pn533_usb) from loading.\n\nSee the note about blacklisting drivers: they can still be loaded manually, so you should create the following file:\n\n```\n/etc/modprobe.d/blacklist.conf\n```\n\n```\ninstall nfc /bin/false\ninstall pn533 /bin/false\ninstall pn533_usb /bin/false\n```\n\nReload udev rules, unload the conflicting modules if they were loaded already:\n\n```\n# rmmod pn533_usb pn533 nfc\n```\n\nor simply reboot.\n\nThere are two options for connecting the tag reader to libnfc. Difference between them is detailed on stackoverflow.\n\n"
    },
    {
      "title": "USB",
      "level": 3,
      "content": "This is the modern and recommended way to use this device.\n\nTo use acr122_usb, you do not need to run the pcsc daemon (libnfc README currently tells you to run it, but this is for the PC/SC way).\n\nInstall libnfc.\n\n"
    },
    {
      "title": "PC/SC",
      "level": 3,
      "content": "This is the legacy and deprecated way to use this device.\n\nInstall ccid and pcsc-tools.\n\n"
    },
    {
      "title": "USB",
      "level": 3,
      "content": "Check if the device is detected:\n\n```\n# nfc-list\n```\n\n```\nnfc-list uses libnfc 1.7.1\nNFC device: ACS / ACR122U PICC Interface opened\n```\n\nReading NFC cards works as well:\n\n```\n# nfc-poll\n```\n\n```\nnfc-poll uses libnfc 1.7.1\nNFC reader: ACS / ACR122U PICC Interface opened\nNFC device will poll during 30000 ms (20 pollings of 300 ms for 5 modulations)\nISO/IEC 14443A (106 kbps) target:\n    ATQA (SENS_RES): 00  04\n       UID (NFCID1): 42  14  3e  2e\n      SAK (SEL_RES): 08\nWaiting for card removing...nfc_initiator_target_is_present: Target Released\ndone.\n```\n\n"
    },
    {
      "title": "PC/SC",
      "level": 3,
      "content": "To test the device run:\n\n```\n# pcscd -f\n```\n\nStart pcscd.service, then put a tag on the reader, the result should look like the following:\n\n```\n# pcsc_scan\n```\n\n```\nPC/SC device scanner\nV 1.4.17 (c) 2001-2009, Ludovic Rousseau <ludovic.rousseau@free.fr>\nCompiled with PC/SC lite version: 1.6.6\nScanning present readers...\n0: ACS ACR122U 00 00\n\nMon Mar 21 18:16:07 2011\n Reader 0: ACS ACR122U 00 00\n  Card state: Card inserted, Shared Mode,\n  ATR: 3B BE 95 00 00 41 03 00 00 00 00 00 00 00 00 00 02 90 00\n\nATR: 3B BE 95 00 00 41 03 00 00 00 00 00 00 00 00 00 02 90 00\n+ TS = 3B --> Direct Convention\n+ T0 = BE, Y(1): 1011, K: 14 (historical bytes)\n  TA(1) = 95 --> Fi=512, Di=16, 32 cycles/ETU\n    125000 bits/s at 4 MHz, fMax for Fi = 5 MHz => 156250 bits/s\n  TB(1) = 00 --> VPP is not electrically connected\n  TD(1) = 00 --> Y(i+1) = 0000, Protocol T = 0\n-----\n+ Historical bytes: 41 03 00 00 00 00 00 00 00 00 00 02 90 00\n  Category indicator byte: 41 (proprietary format)\n\nPossibly identified card (using /usr/share/pcsc/smartcard_list.txt):\n3B BE 95 00 00 41 03 00 00 00 00 00 00 00 00 00 02 90 00\n        touchatag SAM card\n```\n\n"
    },
    {
      "title": "tagEventor",
      "level": 3,
      "content": "tagEventor runs in the background and executes scripts when a tag enters or leaves your tag reader.\n\nDownload a binary version or compile your own.\n\nRun tagEventor to test your installation:\n\n```\n# tagEventor -v 1\n```\n\nThe scripts are located in /etc/gtagEventor. Read the tagEventor documentation on how to use them.\n\n"
    },
    {
      "title": "Firmware [...] is bogus! Upgrade the reader firmware",
      "level": 3,
      "content": "If you encounter a problem like this:\n\n```\nccid_usb.c:859:ccid_check_firmware() Firmware (1.00) is bogus! Upgrade the reader firmware or get a new reader.\nifdhandler.c:104:IFDHCreateChannelByName() failed\nreaderfactory.c:1050:RFInitializeReader() Open Port 200000 Failed (usb:072f/2200:libusb:006)\nreaderfactory.c:233:RFAddReader() ACS ACR122U PICC Interface init failed.\n```\n\nThe libnfc README suggests to do the following:\n\nRemoving the bogus firmware detection of libccid: edit libccid_Info.plist configuration file (usually /etc/libccid_Info.plist) and locate <key>ifdDriverOptions</key>, turn <string>0x0000</string> into 0x0004 to allow bogus devices and restart pcscd.service.\n\n"
    }
  ]
}