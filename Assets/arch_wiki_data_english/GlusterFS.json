{
  "title": "GlusterFS",
  "url": "https://wiki.archlinux.org/title/GlusterFS",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Related articles\n\n- Ceph\n\nGlusterfs is a scalable network filesystem.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the package glusterfs.\n\n"
    },
    {
      "title": "Configuration",
      "level": 2,
      "content": "Glusterfs can be setup to run in many different configurations depending operating needs, including distributed and replicated. For the example below, a two node replicated server is being created, with nodes gluster1 and gluster2 each have two disks, one containing the OS (sda), the other to be shared by glusterfs (sdb). Unless stated, all setup is carried on gluster1:\n\n- Start/enable glusterd.service on both servers.\n\n- Connect the servers\n\n```\n# gluster peer probe gluster2\n```\n\n- Partition and format the glusterfs drive on both servers The upstream advises creating a single partition and formatting this as XFS\n\n- The upstream advises creating a single partition and formatting this as XFS\n\n- On both servers automount the drives by appending /etc/fstab to include the following line, where /dev/sdXY is the appropriate device (e.g., /dev/sdb1).\n\n```\n/etc/fstab\n```\n\n```\n/dev/sdXY /export/sdXY xfs defaults 0 0\n```\n\n- On both servers mount the drives. Then create a brick:\n\n```\n# mkdir -p /export/sdXY/brick\n```\n\n- Enable replication on primary server\n\n```\n# gluster volume create gv0 replica 2 gluster1.mydomain.net:/export/sdb1/brick gluster2.mydomain.net:/export/sdb1/brick\n```\n\n- Ensure volume is created correctly\n\n```\n# gluster volume info\n```\n\n- Start volume\n\n```\n# gluster volume start gv0\n```\n\n- Mount the volume\n\n```\n# mkdir -p /mnt/glusterClientMount\n # mount -t glusterfs gluster1:/gv0 /mnt/glusterClientMount\n```\n\n"
    },
    {
      "title": "Automount gluster volume on boot",
      "level": 2,
      "content": "To mount a gluster volume on boot, systemd needs to wait for both the network, and the glusterd service to be started. You can specify the following fstab options to do this:\n\n```\n/etc/fstab\n```\n\n```\nlocalhost:/gv0 /mnt/glusterClientMount glusterfs defaults,_netdev,x-systemd.requires=glusterd.service,x-systemd.automount 0 0\n```\n\n"
    },
    {
      "title": "See also",
      "level": 2,
      "content": "- Official glusterfs installation guide\n- Blog covering the setup of Glusterfs on Arch Linux\n\n"
    }
  ]
}