{
  "title": "Ethereal",
  "url": "https://wiki.archlinux.org/title/Ethereal",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Wireshark is a free and open-source packet analyzer. It is used for network troubleshooting, analysis, software and communications protocol development, and education.\n\n"
    },
    {
      "title": "Installation",
      "level": 2,
      "content": "Install the wireshark-qt package for the Wireshark GUI or wireshark-cli for just the tshark(1) CLI.\n\ntermshark is an alternative terminal UI.\n\n"
    },
    {
      "title": "Capturing privileges",
      "level": 2,
      "content": "Do not run Wireshark as root; it is insecure. Wireshark has implemented privilege separation, which means that the Wireshark GUI (or the tshark CLI) can run as a normal user while the dumpcap capture utility runs as root[1].\n\nThe wireshark-cli install script sets packet capturing capabilities on the /usr/bin/dumpcap executable.\n\n/usr/bin/dumpcap can only be executed by root and members of the wireshark group, so to use Wireshark as a normal user, you have to add your user to the wireshark user group.\n\n"
    },
    {
      "title": "A few capturing techniques",
      "level": 2,
      "content": "There are a number of different ways to capture exactly what you are looking for in Wireshark, by applying capture filters or display filters.\n\n"
    },
    {
      "title": "Filtering TCP packets",
      "level": 3,
      "content": "If you want to see all the current TCP packets, type tcp into the Filter bar or in the CLI, enter:\n\n```\n$ tshark -f \"tcp\"\n```\n\n"
    },
    {
      "title": "Filtering UDP packets",
      "level": 3,
      "content": "If you want to see all the current UDP packets, type udp into the Filter bar or in the CLI, enter:\n\n```\n$ tshark -f \"udp\"\n```\n\n"
    },
    {
      "title": "Filter packets to a specific IP address",
      "level": 3,
      "content": "- If you would like to see all the traffic going to a specific address, enter display filter ip.dst == 1.2.3.4, replacing 1.2.3.4 with the IP address the outgoing traffic is being sent to.\n- If you would like to see all the incoming traffic for a specific address, enter display filter ip.src == 1.2.3.4, replacing 1.2.3.4 with the IP address the incoming traffic is being sent to.\n- If you would like to see all the incoming and outgoing traffic for a specific address, enter display filter ip.addr == 1.2.3.4, replacing 1.2.3.4 with the relevant IP address.\n\n"
    },
    {
      "title": "Exclude packets from a specific IP address",
      "level": 3,
      "content": "```\nip.addr != 1.2.3.4\n```\n\n"
    },
    {
      "title": "Filter packets to LAN",
      "level": 3,
      "content": "To only see LAN traffic and no internet traffic, run\n\n```\n(ip.src==10.0.0/8 AND ip.dst==10.0.0/8) OR (ip.src==172.16.0.0/12 AND ip.dst==172.16.0.0/12) OR (ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16)\n```\n\nThis will filter traffic within any of the private network spaces.\n\n"
    },
    {
      "title": "Filter packets by port",
      "level": 3,
      "content": "See all traffic on two ports or more:\n\n```\ntcp.port==80||tcp.port==3306\ntcp.port==80||tcp.port==3306||tcp.port==443\n```\n\n"
    },
    {
      "title": "Headless capturing with dumpcap",
      "level": 3,
      "content": "dumpcap is part of Wireshark and can be used for capturing packets without the GUI. Used in combination with tmux will allow the capture of packets in a detached session.\n\nTo see all dumpcap options, use the -h flag.\n\nThe following example will provide a ringbuffer capture. It captures twenty .pcap files of 100MB each, replacing the oldest file with the twenty-first file and so on… This allows a continuous capture without exhausting disk space.\n\n```\n# dumpcap -i 1 -b filesize:100000 -b files:20 -w mycapture.pcapng\n```\n\n- -i − interface number (listed from dumpcap -D)\n\n- -b filesize: − file size in kB before starting a new .pcap file\n\n- -b files: − the number of files to capture before overwriting the oldest\n\n- -w − write the output to the file mycaptureidentifier.pcapng\n\n"
    }
  ]
}